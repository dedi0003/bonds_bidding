---
title: "Determining Factors for 10-year Local Currency Sovereign Bonds Yield: Indonesia Case"
author: "Dea Avega Editya"
date: "8/5/2021"
output:
  bookdown::pdf_document2:
    toc_depth: 4
  html_document: default
bibliography: baca.bib  

---
<style>
body {
text-align: justify}
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(dplyr)
library(ggplot2)
library(tidyverse)
library(readr)
library(readxl)
library(stringr)
library(lubridate)
library(janitor)
library(cleaner)
library(plotly)
library(tsibble)
library(openxlsx)
library(zoo)
library(purrr)
library(sugrrants)
library(GGally)
library(scales)
library(flipTime)
library(caret)
library(patchwork)
library(stargazer)

#read compiled dataset
yield_factors <- readRDS("yield_factors.rds")

```

\newpage

# Introduction

Indonesian government regularly issue Rupiah-denominated sovereign bonds (conventional and sharia bonds) in the primary market to finance the deficit of the national budget. In 2021, the issuance target for the sovereign bonds is around 80-85% of total deficit financing which amounts to IDR1,006 Trillion or equivalent to USD72 Billion ^[Assumed exchange rate for conversion (IDR/USD) = 14,284.00]. As of 2 September 2021, the total outstanding of local currency sovereign bonds is IDR4,539 Trillion or equivalent to USD318 billion ^[ibid]. 

The government sells the sovereign bonds through an auction which is conducted every Tuesday. The announcement will be released three days before the auction day (T-3). During a 2-hour auction, investors (both individuals and institutions) can put their bidding in multiple prices through primary dealers, and auction winners will pay their bonds based on their proposed volumes and yields. In addition to the multiple price (competitive) mechanism, the government also offers sovereign bonds to several non-competitive participants such as Indonesia Central Bank (Bank Indonesia) and Indonesia Deposit Insurance Corporation (Lembaga Penjamin Simpanan). This non-competitive buying may also be conducted by primary dealers to complement their competitive bidding purchase. Non-competitive buyers will pay their bonds based on weighted average yield (WAY) from the winning competitive bidding.

There are several benchmark series offered in the auction. These series represent various maturity times. For conventional bonds, tenors of benchmark series in 2021 are ranging from 5, 10, 15, and 20 years. Meanwhile, benchmark tenors of sharia bonds cover 2, 4, 13, and 25 years.  
  
Since 2021, the yield of 10-year sovereign bonds has become one of the macroeconomic assumptions in the national budget, replacing treasury bills of tenor 3-month (Surat Perbendaharaan Negara). This replacement is because the yield of 10-year sovereign bonds is deemed as having a larger and more significant portion in the nation's cost of borrowing compared to the T-bills. Moreover, the 10-year yield is also reflecting long-term economic development and its movement is commonly used as a sign for predicting country's economic health. 

During a period of 2014-2018, Indonesia is said to have a higher average of 10-year sovereign bonds yield compared to its ASEAN-5 peers (Thailand, Philippines, Malaysia, Vietnam) as well as several other emerging countries with similar credit ratings like Mexico, Columbia, and India [@Muktiyanto2019]. This condition makes Indonesia pays more expensive debt compared to these countries. As corporate and business use the yield for benchmarking when issuing local currency bonds as well as lending money, the impact of costly debt is also spilled over in the national economy.

Considering the important functions of the 10-year sovereign bonds yield in Indonesia's economy, this study will analyze several variables that determine the yield and quantify their impact using the Ordinary Least Squared (OLS) model. This paper will be delivered in several sections. First, we will explain our research's purpose in Section 2. Section 3 will provide background knowledge from prior studies related to the topic. Section 4 will briefly explain variables of interest as well as conducting exploratory data analysis (EDA) by visualizing data to check any interesting patterns or characteristics. Section 5 and section 6 will cover the research methodology and result of analysis consecutively. The appendix contains all detailed visualizations.

# Motivation

This paper provides two new values to existing literature. First, it employs an exploratory data analysis (EDA) approach at the beginning of analysis to gain better intuition of each explanatory variable. This approach is quite important especially for capturing particular data characteristics, i.e. non-linearity before we can proceed to a confirmatory step. Disregarding the data characteristic will result in inappropriate data modeling.
Second, this is the first work that empirically studies the impact of primary dealers' behavior on the 10-year local currency sovereign bonds yield in Indonesia.  
The purpose of this work will be to provide insights and policy recommendations for the government in reducing sovereign bonds yield, particularly by aiming at significant determinant factors, which in turn help to optimize the national's cost of borrowing. 

# Literature Review

Numerous researches have been conducted using various methodologies and scopes of study to find factors that affecting sovereign bonds yield. Dachroui et al [@Dachraoui2020] analyze role of capital flight as a driver of sovereign bond spreads in Latin American countries. They found that spreads are positively correlated with capital flight, inflation, government final consumption expenditure, unemployment rate, VIX and crisis, while economic growth, trade openness and governance index appear to have a negative effect [-@Dachraoui2020]. 

UST


CDS
Kim et al. [-@Kim2014] study role of default risk using credit default swaps as proxy in explaining spread of sovereign bonds yield. Their finding confirm that the variable contributes in determining the spread by 37%.

EXCHANGE RATE
Gadanecz et al [@Gadanecz2018] use exchange rate volatility and expected exchange rate as predictor variables of emerging market economies local currency sovereign bond yields. They conclude that the significant relationship between exchange rate and bonds yields. Permanasari et al. [-@Permanasari2021] see negative significant relationship between exchange rate and government bond yield in Indonesia, while Saenong et al [@Saenong2020] conclude that exchange rate has an effect on bond yields only in the short run. 

FOREIGN
[@Gadanecz2018] Moreover, they also found that foreign ownership in local currency sovereign bonds market plays important role as stabilizing force of exchange rate volatility. 

Other studies such as,,,,also confirm this.

VIX
Izadi et al [@Izadi2018] focus on local fundamental, global factors, volatility as determinant factors of yield spreads using empirical data of 24 developed countries in
North America, Europe and Pacific Rim regions in period of January, 2010 until March, 2015. Their finding include significant and positively correlation between equity market volatility (VIX) and yield speads in all observed regions. Their study also show strong relationship between fixed income and stock markets particularly in developed countries.

Other researches took different angle by looking at primary dealers system and its impact on bonds yield Tchuindjo et al.[-@Tchuindjo2015], Endo [-@Endo2020], Nyborg et al. [-@Nyborg2004], Mercer et al. [-@Mercer2013], and Ferrari et al. [-@Ferrari2018]. Endo [-@Endo2020] study role of primary dealers in low income economies, while Ferrari et al. [-@Ferrari2018] focus on primary dealers' funding constraints on sovereign bonds yield. Nyborg et al. [-@Nyborg2004], Mercer et al. [-@Mercer2013] and Tchuindjo [-@Tchuindjo2015] concern on primary dealers trading behavior in US Treasury auction. The last name also provide several mathematical models to estimate the impact of primary dealers' strategic behavior in the auction [-@Tchuindjo2015].


# Data Description

Based on these existing literature, this paper will study relationship and impact of 10-year US Treasury (UST) yield, 5-year Credit Default Swap (CDS), foreign share in sovereign bonds ownership (%), central bank's policy rate, exchange rate, volatility index (VIX) as well as primary dealers' behavior on a response variable of the 10-year local currency sovereign bonds yield. All variables are collected as time-series data covering period of 2 January 2015 until 5 August 2021. 

## 10-year Local Currency Sovereign Bonds Yield  

Yield can be described as expected return in exchange of risks taken by investors. The 10-year yield data used in this study is a generic yield retrieved from Bloomberg platform by using ticker "GRR" (Global summary of government bill, note, and benchmark bond rates for individual countries). 

Furthermore, as yield's definition is associated with risks, we can group the explanatory variables based on their related risk categories as follow:

## External Risk  

### 10-year US Treasury
```{r}
yield_factors %>% 
  mutate(week_year = yearweek(date), year = year(date), foreign_chg = foreign/tot_ownership) %>% 
  ggplot(aes(x = ust_10y, y = domestic_10y)) + 
  geom_point(alpha = 0.3)+facet_wrap(~ year, scale = "free")+theme_light()+ylab("10y Yield")+xlab("10y UST")
```

### Foreign Ownership  
```{r}
#foreign changes
## negative relationship when foreign pct > 35%, < 35% positive relationship
### due to quantitative easing of central bank 2020-2021 and mandatory purchase of domestic banks boost domestic ownership

yield_factors %>% 
  mutate(week_year = yearweek(date), year = year(date), foreign_chg = foreign/tot_ownership) %>% 
  ggplot(aes(x = foreign_chg, y = domestic_10y)) + 
  geom_point(alpha = 0.3)+facet_wrap(~ year, scale = "free")+theme_light()+ylab("10y Yield")+xlab("Foreign Ownership (%)")
```


## Default Risk (5-year Credit Default Swap) 

A credit default swap (CDS) is a derivative contract that allows the investor to hedge against the default of a borrower. 
This provides a market-based measure of the credit-risk premium. 
CDS spreads indicate that the credit risk that investors
perceive is significant. @codogno

```{r}
###cds vs yield 
yield_factors %>%
  mutate(year = year(date)) %>%
  mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_ust = domestic_10y-ust_10y, spread_bi = domestic_10y-rate, ust_bi = rate-ust_10y) %>%
  filter(year > 2015) %>%
  ggplot(aes(x = cds_5y, y = domestic_10y))+
  geom_jitter(alpha = 0.3)+
  facet_wrap(~year,  scale = "free")+theme_light()+ylab("5y CDS")+xlab("10y Yield")
```


## Financial Market Risk (Volatility Index)  

```{r}
#check volatility vs yield
yield_factors %>% mutate(year = year(date)) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = vix), alpha = 0.5) +
  facet_wrap(~year, scale = "free")+theme_light()+ylab("10y Yield") + xlab("VIX")

```


## Macroeconomic Risk (Exchange Rate USD/IDR)  

```{r}
#check exchange rate vs yield
# strong and steady positive relationship between exchange rate and yield
# Rupiah weakened yield goes up
yield_factors %>% mutate(year = year(date)) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = exchange_mid)) +
  facet_wrap(~year, scale = "free")+theme_light()+ylab("10y Yield") + xlab("Exchange Rate (IDR/USD)")
```


## System Risk (Primary Dealers Behavior) 

Primary dealers system in Indonesia has been established since 2007. The system is expected to run several functions as shown in more developed economies. Arnone and Arden [-@Arnone2003] describe role of primary dealers as intermediary between debt managers and investors in primary market, bookmakers and bonds distributors, liquidity provider between primary and secondary market, promoter of continuous market and efficient price discovery, and adviser to government.

In 2021, there are 20 primary dealers of conventional bonds comprise of 16 conventional banks and 4 securities companies. For sharia bonds, there are also 20 primary dealers consist of 13 conventional banks, 3 Islamic banks and 4 securities companies. Primary dealers are required to participate in every auction and to bid for a minimum quantity of the total offering amount. They can bid both on behalf of their customers and for their own accounts. As primary dealers can participate in competitive bidding in primary market as well as buy and sell in secondary market, they have direct contribution on forming yield of sovereign bonds.

Tchuindjo [-@Tchuindjo2015] writes that primary dealers will make bilateral contracts for the offered securities as soon as auction announced, known as pre-sale or when-issued market. Mercer et al. [-@Mercer2013] argue that they will be able to "discover" the ultimate auction price since in pre-sale period. Many primary dealers are also believed to often short in the when-issued market [@Nyborg2004], which encourages them to bid aggressively and assign lower prices to the auctioned securities [@Tchuindjo2015], meaning higher demanded yields.

Thus, our analysis will be based on an assumption that primary dealers’ strategic behavior in the auctions can affect sovereign bonds yield. To check this assumption, we use dummy variables of "auction days" that representing the pre-sale/when-issued period and "non-auction days" that representing regular workdays. Referring to Nyborg et al. [-@Nyborg2004] pre-sale period is described as days started from the day of auction announcement (T-3) until a moment before bonds is distributed on the day of settlement (T+2). For simplicity, we define auction days as days started from T-3 until T+1. Here, we exclude the day of settlement (T+2) since bonds is usually distributed by the Central Bank in the morning of the settlement day. In addition, we only include auction days that offer benchmark series of the 10-year sovereign bonds in the auction day (T). Before 2019, the 10-year series is not regularly offered in the auction.

In the graph below, we will observe the pattern of 10-year yield movement and the dummy categories.

```{r echo = FALSE}
### auction vs non_auc days
average_2015 <- yield_factors %>% mutate(year = year(date)) %>%  filter(year == 2015) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2016 <- yield_factors %>% mutate(year = year(date)) %>%  filter(year == 2016) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2017 <- yield_factors %>% mutate(year = year(date)) %>% filter(year == 2017) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2018 <- yield_factors %>% mutate(year = year(date)) %>% filter(year == 2018) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2019 <- yield_factors %>% mutate(year = year(date)) %>% filter(year == 2019) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2020 <- yield_factors %>% mutate(year = year(date)) %>% filter(year == 2020) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2021 <- yield_factors %>% mutate(year = year(date)) %>% filter(year == 2021) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

```


From figure \@ref(fig:yieldmove), volatility in non auction days (post auction) is also tend to be higher than volatility in auction days.

```{r yieldmove, fig.cap="10-year Yield's Movement during Auction Days during January-August 2021^[Full period of observation can be seen in the Appendix]"}
#   
yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>%
  filter(year == 2021) %>% 
ggplot(aes(x = factor(day(date)), y = domestic_10y, color = factor(auction_day), alpha = 0.1))+
  geom_jitter(alpha = 0.6, size = 2)+scale_x_discrete(breaks = seq(1, 31, 9))+scale_y_continuous(minor_breaks = 1)+
  geom_hline(data = average_2021, aes(yintercept = mean, linetype = "Monthly Average"), colour= 'black')+
  facet_wrap(~month, ncol = 3)+xlab("Date")+ylab("10y Yield")+
  scale_color_manual(name = "Auction Days", values= c("#BCBCBC", "#F55F5F"), labels = c("No", "Yes"))+
  scale_linetype_manual(name = "", values = "dashed")+theme_light()+theme(legend.position="bottom")

```




```{r fig.cap= "Boxplot of 10-year Yield's Movement during Auction Days during January-August 2021^[ibid]"}
######comparing yield in auction day and non-auction day
# slightly higher in Feb and Dec
yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>% 
  select(domestic_10y, auction_day, month, year) %>% drop_na() %>% 
  filter(year == 2021) %>% 
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~ month)+ylab("10-year Yield")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position = "bottom")
```

```{r fig.cap="10-year Yield's Movement during Auction Days from 2016-2021"}
yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>%
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~month)+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+
  theme_light()+theme(legend.position = "bottom")

```


# Research Methodology

In selecting determining factors for the 10-year sovereign bonds, we are mainly influenced by prior studies conducted by Gadanecz [-@Gadanecz2018], Tchuindjo [-@Tchuindjo2015], ......

## Stationary Test

To ensure that our model is not biased, we will conduct stationery test on the variables using Augmented Dicky Fuller (ADF) and KPSS.

```{r}
library(forecast)



```


## Cointegration test

### Visual Test

```{r}
# plot both interest series

# spread_ust <- yield_factors$domestic_10y-yield_factors$ust_10y
# yield_factors %>% 
#   ggplot(aes(x = date))+
#   geom_area(aes(y = domestic_10y), alpha = 0.4, fill = "steelblue")+
#   geom_line(aes(y = domestic_10y), color = "blue", alpha = 0.5)+
#   geom_area(aes(y = ust_10y), alpha = 0.2, fill = "darkred")+
#   geom_line(aes(y = ust_10y), color = "red", alpha = 0.5)+
#   geom_line(aes(y= spread_ust), alpha = 0.6)+
#   geom_hline(yintercept = mean(spread_ust), linetype = "dashed")

yield_scale <- yield_factors %>% 
  mutate(for_pct = foreign/tot_ownership) %>% 
  select_if(is.numeric) %>% 
  scale() %>% as_tibble()

yield_scale <- cbind(yield_factors$date, yield_scale) %>% rename(date = `yield_factors$date`)

spread_ust <- yield_scale$domestic_10y-yield_scale$ust_10y
yield_scale %>% 
  ggplot(aes(x = date))+
  geom_area(aes(y = domestic_10y), alpha = 0.1, fill = "steelblue")+
  geom_line(aes(y = domestic_10y), color = "blue", alpha = 0.1)+
  geom_area(aes(y = ust_10y), alpha = 0.1, fill = "darkred")+
  geom_line(aes(y = ust_10y), color = "red", alpha = 0.1)+
  geom_line(aes(y= spread_ust), alpha = 0.6)+
  geom_hline(yintercept = mean(spread_ust), linetype = "dashed")+ggtitle("Diff with UST")

#the spread between cds and yields looks whitenoise
#The plot suggests that 10y domestic and 10y UST are cointegrated: 
# both seem to have the same long-run behavior. They share a common stochastic trend. The spread, which is obtained by taking the difference between 2 variables, seems to be stationary. In fact, the expectations theory of the term structure suggests the cointegrating coefficient (theta) to be 1. This is consistent with the visual result.

spread_cds <- yield_scale$domestic_10y-yield_scale$cds_5y
yield_scale %>% 
  ggplot(aes(x = date))+
  geom_area(aes(y = domestic_10y), alpha = 0.1, fill = "steelblue")+
  geom_line(aes(y = domestic_10y), color = "blue", alpha = 0.1)+
  geom_area(aes(y = cds_5y), alpha = 0.1, fill = "darkred")+
  geom_line(aes(y = cds_5y), color = "red", alpha = 0.1)+
  geom_line(aes(y= spread_cds), alpha = 0.6)+
  geom_hline(yintercept = mean(spread_cds), linetype = "dashed")+ggtitle("Diff with CDS")

#the diff between cds and yields looks stationer

yield_scale <- yield_scale %>% 
  mutate(dif_fx = domestic_10y-exchange_mid)

yield_scale %>% 
  ggplot(aes(x = date))+
  geom_area(aes(y = domestic_10y), alpha = 0.1, fill = "steelblue")+
  geom_line(aes(y = domestic_10y), color = "blue", alpha = 0.1)+
  geom_area(aes(y = exchange_mid), alpha = 0.1, fill = "darkred")+
  geom_line(aes(y = exchange_mid), color = "red", alpha = 0.1)+
  geom_line(aes(y= dif_fx), alpha = 0.6)+
  geom_hline(yintercept = mean(yield_scale$dif_fx), linetype = "dashed")+ggtitle("Diff with FX")

#the diff with FX is NON-stationer...

tab <- cbind(yield_scale$domestic_10y, yield_scale$for_pct) %>% as.data.frame()
tab <- tab %>% 
  mutate(dif_for = V1-V2)

yield_scale %>% 
  ggplot(aes(x = date))+
  geom_area(aes(y = domestic_10y), alpha = 0.1, fill = "steelblue")+
  geom_line(aes(y = domestic_10y), color = "blue", alpha = 0.1)+
  geom_area(aes(y = for_pct), alpha = 0.1, fill = "darkred")+
  geom_line(aes(y = for_pct), color = "red", alpha = 0.1)+
  geom_line(aes(y= tab$dif_for), alpha = 0.6)+
  geom_hline(yintercept = mean(tab$dif_for), linetype = "dashed")+ggtitle("Diff with Foreign pct")


spread_rate <- yield_scale$domestic_10y-yield_scale$rate

yield_scale %>% 
  ggplot(aes(x = yield_factors$date))+
  geom_area(aes(y = domestic_10y), alpha = 0.1, fill = "steelblue")+
  geom_line(aes(y = domestic_10y), color = "blue", alpha = 0.1)+
  geom_area(aes(y = rate), alpha = 0.1, fill = "darkred")+
  geom_line(aes(y = rate), color = "red", alpha = 0.1)+
  geom_line(aes(y= spread_rate), alpha = 0.6)+
  geom_hline(yintercept = mean(spread_rate), linetype = "dashed")

#diff with policy rate looks stationer

spread_vix <- yield_scale$domestic_10y-yield_scale$vix

yield_scale %>% 
  ggplot(aes(x = yield_factors$date))+
  geom_area(aes(y = domestic_10y), alpha = 0.1, fill = "steelblue")+
  geom_line(aes(y = domestic_10y), color = "blue", alpha = 0.1)+
  geom_area(aes(y = vix), alpha = 0.1, fill = "darkred")+
  geom_line(aes(y = vix), color = "red", alpha = 0.1)+
  geom_line(aes(y= spread_vix), alpha = 0.6)+
  geom_hline(yintercept = mean(spread_vix), linetype = "dashed")

# diff with vix looks stationer

```

### Formal Test


Regarding the result from the exploratory data analysis conducted in previous section as well as the cointegration test, we can write down relationship between variables in OLS model as follow:

$$
\begin{aligned}
yield\_10y = &\alpha + \beta_1ust\_10y+\beta_2cds\_5y +\beta_3foreign\_pct + \beta_4policy\_rate +\beta_5exchange\_rate
\\
&+ \beta_6{vix}^2 + \beta_7auction\_days +\epsilon
\end{aligned}
$$


Summary statistic of the data is shown in table \@ref(tab:table1):

```{r table1, results = 'asis'}

###prepare variable for model
data_model <- yield_factors %>% mutate(year = year(date), month = factor(month(date))) %>% 
  mutate(foreign_pct = foreign/tot_ownership) %>% 
  mutate(date= date(date), year = factor(year), month =  factor(month(date)),
          auction_day = factor(auction_day)) %>% 
  select(date,  year, month, domestic_10y, cds_5y, ust_10y, rate, foreign_pct, vix, exchange_mid, auction_day) %>% drop_na()


stargazer(as.data.frame(data_model), type = "latex", header = FALSE,
          covariate.labels=c("10y Yield","5y CDS", "10y UST", "Policy Rate", "Foreign Pct", "VIX", "Exchange Rate"), label = "tab:table1")
```



# Analysis

```{r eval = FALSE}
library(broom)

# model <- lm(formula = domestic_10y ~ cds_5y + ust_10y + rate:year + foreign + ins_pension + foreign:year + ins_pension:year + auction_day:month,
#  data = data_model)

model <- lm(formula = domestic_10y ~ cds_5y + ust_10y + rate + foreign_pct + I(vix^2) + exchange_mid + auction_day,
            data = data_model)

summary(model)
tidy(model)

# highest vix in early pandemic 2020-03-16 
# MArch 2 2020 is the first case of covid
data_model %>% filter (vix == 82.69)


# best <- drop1(model, test = "F")
# summary(best)


aug <- broom::augment(model, data = data_model %>% filter(year != 2015) %>% drop_na())

aug %>% 
  ggplot(aes(x = .fitted, y = .resid))+
  geom_point()

aug %>%
  ggplot(aes(x = .cooksd, y = .hat))+
  geom_point()

# aug %>% 
#   ggplot(aes(x = .cooksd, y = .hat))+
#   geom_point()

outlier <- aug %>% filter(.cooksd > 0.05)

#not in
`%notin%` <- Negate(`%in%`)

data_model %>% filter(date %in% outlier$date)

####remove extreme outliers
data_model2 <- data_model %>% filter(date %notin% outlier$date)

# model <-  lm(formula = domestic_10y ~ cds_5y + ust_10y + rate + foreign:year + I(vix^2) + exchange_mid + auction_day:month, data = data_model2)


# model <- lm(formula = domestic_10y ~ cds_5y + ust_10y + rate + foreign:year + I(vix^2) + cpi_inflation + exchange_mid + auction_day:year,
#             data = data_model)

summary(model)
tidy(model)

aug <- broom::augment(model, data = data_model2 %>% filter(year != 2015) %>% drop_na())

aug %>% 
  ggplot(aes(x = .fitted, y = .resid))+
  geom_point()

aug %>% 
  ggplot(aes(x = .cooksd, y = .hat))+
  geom_point()

#check multicol
#explain GVIF variable 
car::vif(model)

# reduce to "best fit" model with

summary(model)
# model_best <- step(model, trace = FALSE)
# summary(model_best)

#diagnose model
ggnostic(model_best)

```


In particular, the results suggest that
improved macroeconomic fundamentals, such as higher net foreign assets (in
terms of GDP or imports), lower fiscal deficits, and lower ratios of debt service to
exports and debt to GDP, help to lower sovereign spreads @arora

a. UST vs Yield
While the dramatic rise in capital flows to
emerging markets has been induced primarily by the implementation of sound
macroeconomic policies and wide structural reforms in these countries, it has
also been driven by changing conditions in industrial countries that have
encouraged investors to diversify their portfolios into developing country
assets.  Interest rate spreads (the differences between yields on
sovereign bonds of developing countries and U.S. treasury securities of
comparable maturities), which are a proxy for country risk, have tended to
move in the same direction as the changes in U.S. interest rates @arora

b. CDS vs Yield

Sovereign CDS spreads are used as an indicator of foreign currency sovereign
creditworthiness. Lower sovereign CDS spreads are expected to lower local currency sovereign bond yields @gadanecz

c. Foreign Ownership vs Yield

d. Bank Indo Rate vs Yield

e. Exchange rate (JISDOR) vs Yield
Investors are exposed to gains and losses from exchange rate movements on their holdings of local currency sovereign bond. exchange rate risk can represent an important channel of transmission of market sentiment, uncertainty and default risk to local currency bond yield 
Exchange rate risk tends to affect liquidity
conditions in both foreign exchange and domestic bond markets, which tend to be relatively low in many EMEs even in tranquil times.
The direction of the
causality runs from exchange rate volatility to local currency sovereign bond yields. This is especially the case in Asia and eastern
Europe. In these two regions, local currency sovereign bond markets are relatively liquid and foreign participation relatively large.

The sensitivity of EME local currency sovereign bond yields to exchange rate volatility increases after
the global financial crisis, and further after the taper tantrum in mid-2013
@gadanecz


f. Volatility index (VIX) vs Yield
It is a measure of market expectations of near-term volatility conveyed by S&P500 stock index option prices and considered as a forward-looking measure of investor risk. Hartelius et al. (2008) highlights the strong dependence of emerging market returns to the VIX, which should be positively
related to changes in emerging market spreads since more risk aversion increases spreads. An attractive feature of this index is that it can
be considered as exogenous for emerging economies (Siklos, 2011). @hajer

This result could be explained by the fact that as investors become more risk-averse and seek safer assets, the expected growth in volatility encourages them to liquidate their positions in risky assets in favor of safer ones, thus increasing sovereign spreads.
@hajer

Intended to capture changes in investor sentiment which may be related to
expected changes in U.S. monetary policy. It may also pick up the effects of other market-related events, such as the flight to quality effects during the Asian crisis.
@arora

As historical data demonstrates a strong negative correlation of volatility to the stock market returns – that is, when stock returns go down, volatility rises and vice versa.(investopedia)



# Conclusion






factors that steadily affect the yield? (foreign and insurance/pension fund are steadily associated with yield movement. Foreign has strongly negative correlation until 2019, while insurance/pension has strongly positive correlation)

pandemic effect? i.e. holding spending for investing in safe instrument? (need to check ownership of domestic banks, mutual funds, insurance, individual investors) 

shifting power (bonds ownership) foreign to domestic participant (Do central bank/domestic banks become more dominant)?
(Quantitative easing of Bank Indonesia and mandatory purchase of domestic banks can push down the yield)


```{r }

# 
# 
# #check debt_gdp ratio vs yield
# yield_factors %>% mutate(year = year(date)) %>% 
#   ggplot(aes(y = domestic_10y)) + 
#   geom_jitter(aes(x = debt_gdp))+
#   facet_wrap(~year)

```


```{r foreign_yield, fig.cap = "Foreign Ownership and Domestic 10y Yield", eval=FALSE}

# yield_factors %>%  mutate(year = year(date), con_pct = con_bank/tot_ownership, bi_pct = central_bank/tot_ownership, ins_pct = ins_pension/tot_ownership) %>% 
#   # filter(year == 2019) %>% 
#   select(date, foreign, central_bank, individual, mutual_fund, con_bank, islam_bank, ins_pension, others) %>%
#   gather(key = "variable", value = "value", -date) %>% 
#   ggplot(aes(x = variable, y = value/1000, fill = value))+
#   geom_col()+
#   coord_flip()+
#   theme(legend.title = element_blank())


# yield_factors %>% 
#   mutate(year = year(date), con_pct = con_bank/tot_ownership, bi_pct = central_bank/tot_ownership, ins_pct = ins_pension/tot_ownership) %>% 
#   ggplot(aes(y = domestic_10y))+
#   geom_point(aes(x = con_pct, color = "red"))+
#   geom_point(aes(x = bi_pct))+
#   theme(legend.title = element_blank())+facet_wrap(~ year)

## others has strong positive correlation with yield
yield_factors %>% 
mutate(year = year(date), mon = month(date), con_pct = con_bank/tot_ownership, bi_pct = central_bank/tot_ownership, others_pct = others/tot_ownership) %>% 
  ggplot(aes(x = others, y = domestic_10y)) + 
  geom_point() +
  facet_wrap(~ year)

#check ownership in auction days
# yield_factors %>%
# mutate(year = year(date), month = month(date), con_pct = scale(con_bank/tot_ownership), bi_pct = central_bank/tot_ownership, others_pct = scale(others/tot_ownership), ins_pct = scale(ins_pension/tot_ownership)) %>%
#   filter(year == 2019, month == 2) %>%
#   ggplot(aes(x = date)) +
#   geom_line(aes(y = ins_pct))+
#   geom_line(aes(y = con_pct, color = "red"))+
#   geom_point(aes(y = auction_day, color = factor(auction_day)))


# bi and con_bank is balancing each other
# since 2020, they move in the same direction
# burden sharing for pandemic
yield_factors %>% 
mutate(year = year(date), con_pct = con_bank/tot_ownership, bi_pct = central_bank/tot_ownership, others_pct = scale(others/tot_ownership), ins_pct = ins_pension/tot_ownership) %>% 
  ggplot(aes(x = date)) + 
  geom_line(aes(y = bi_pct))+
  geom_line(aes(y = con_pct))

###CDS vs UST spread
# yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_ust = domestic_10y-ust_10y) %>%  
#   filter(year == 2021) %>% 
#   ggplot(aes(x = date)) + 
#   geom_line(aes(y = sqrt(spread_10)))+
#   geom_line(aes(y = sqrt(spread_5)), color = "red", alpha = 0.5)+
#   geom_line(aes(y = spread_ust), color = "blue")+
#    scale_x_date(labels = date_format("%m-%Y"))


### CDS vs centralbank rate spread

# yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_bi = domestic_10y-rate) %>%  
#   filter(year == 2021) %>% 
#   ggplot(aes(x = date)) + 
#   geom_line(aes(y = sqrt(spread_10)))+
#   geom_line(aes(y = sqrt(spread_5)), color = "red", alpha = 0.5)+
#   geom_line(aes(y = spread_bi), color = "blue")+
#    scale_x_date(labels = date_format("%m-%Y"))


# ust vs policy rate vs spread rate-ust
# check how differ central bank rate from UST
# yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_ust = domestic_10y-ust_10y, spread_bi = domestic_10y-rate, ust_bi = rate-ust_10y) %>% 
#   filter(year > 2015) %>% 
#   ggplot(aes(x = date)) + 
#   geom_area(aes(y = ust_bi), fill = "darkgreen", alpha = 0.5)+
#   geom_line(aes(y = rate))+
#   geom_line(aes(y = ust_10y), color = "red")+
#   # geom_line(aes(y = spread_ust))+
#   # geom_line(aes(y = spread_bi), color = "red", alpha = 0.5)+
#   scale_x_date(labels = date_format("%m-%Y"))
  
# yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_ust = domestic_10y-ust_10y, spread_bi = domestic_10y-rate, ust_bi = rate-ust_10y) %>%  
#   filter(year > 2015) %>% 
#   ggplot(aes(x = spread_ust, y = domestic_10y))+
#   geom_jitter()

###spread ust vs yield in 2019 and 2021 is not strongly associated
# yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_ust = domestic_10y-ust_10y, spread_bi = domestic_10y-rate, ust_bi = rate-ust_10y) %>%  
#   filter(year > 2015) %>% 
#   ggplot(aes(x = spread_ust, y = domestic_10y))+
#   geom_jitter()+ facet_wrap(~year)

###spread bi vs yield 
# yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_ust = domestic_10y-ust_10y, spread_bi = domestic_10y-rate, ust_bi = rate-ust_10y) %>%  
#   filter(year > 2015) %>% 
#   ggplot(aes(x = spread_bi, y = domestic_10y))+
#   geom_jitter()+
#   facet_wrap(~year)



# yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_ust = domestic_10y-ust_10y, spread_bi = domestic_10y-rate, ust_bi = rate-ust_10y) %>%  
#   filter(year > 2015) %>% 
#   ggplot(aes(x = cds_10y, y = domestic_10y))+
#   geom_jitter()+
#   facet_wrap(~year)


# spread movement
# spread_2016 <- yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = domestic_10y - cds_10y/100, spread_5 = domestic_10y - cds_5y/100, spread_ust = domestic_10y-ust_10y) %>% 
#   filter(year == 2016) %>% 
#   ggplot(aes(x = date)) + 
#   geom_line(aes(y = spread_10))+
#   geom_line(aes(y = spread_5), color = "red", alpha = 0.5)+
#   geom_line(aes(y = spread_ust), color = "blue")+
#    scale_x_date(labels = date_format("%m-%Y"))


# spread_2017 <- yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = domestic_10y - cds_10y/100, spread_5 = domestic_10y - cds_5y/100, spread_ust = domestic_10y-ust_10y) %>% 
#   filter(year == 2017) %>% 
#   ggplot(aes(x = date)) + 
#   geom_line(aes(y = spread_10))+
#   geom_line(aes(y = spread_5), color = "red", alpha = 0.5)+
#   geom_line(aes(y = spread_ust), color = "blue")+
#    scale_x_date(labels = date_format("%m-%Y"))
# 
# spread_2018 <- yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = domestic_10y - cds_10y/100, spread_5 = domestic_10y - cds_5y/100, spread_ust = domestic_10y-ust_10y) %>% 
#   filter(year == 2018) %>% 
#   ggplot(aes(x = date)) + 
#   geom_line(aes(y = spread_10))+
#   geom_line(aes(y = spread_5), color = "red", alpha = 0.5)+
#   geom_line(aes(y = spread_ust), color = "blue")+
#    scale_x_date(labels = date_format("%m-%Y"))
# 
# spread_2019 <- yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = domestic_10y - cds_10y/100, spread_5 = domestic_10y - cds_5y/100, spread_ust = domestic_10y-ust_10y) %>% 
#   filter(year == 2019) %>% 
#   ggplot(aes(x = date)) + 
#   geom_line(aes(y = spread_10))+
#   geom_line(aes(y = spread_5), color = "red", alpha = 0.5)+
#   geom_line(aes(y = spread_ust), color = "blue")+
#    scale_x_date(labels = date_format("%m-%Y"))
# 
# spread_2020 <- yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = domestic_10y - cds_10y/100, spread_5 = domestic_10y - cds_5y/100, spread_ust = domestic_10y-ust_10y) %>% 
#   filter(year == 2020) %>% 
#   ggplot(aes(x = date)) + 
#   geom_line(aes(y = spread_10))+
#   geom_line(aes(y = spread_5), color = "red", alpha = 0.5)+
#   geom_line(aes(y = spread_ust), color = "blue")+
#    scale_x_date(labels = date_format("%m-%Y"))
# 
# spread_2021 <- yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   mutate(date= date(date), month =  month(date), spread_10 = domestic_10y - cds_10y/100, spread_5 = domestic_10y - cds_5y/100, spread_ust = domestic_10y-ust_10y) %>% 
#   filter(year == 2021) %>% 
#   ggplot(aes(x = date)) + 
#   geom_line(aes(y = spread_10))+
#   geom_line(aes(y = spread_5), color = "red", alpha = 0.5)+
#   geom_line(aes(y = spread_ust), color = "blue")+
#   scale_x_date(labels = date_format("%m-%Y"))
# 
# 
# plot_spread <- patchwork::wrap_plots(spread_2016, spread_2017, spread_2018, spread_2019, spread_2020, spread_2021, ncol = 3)
###spread mostly below cds, except in 2016 and 2020 after pandemic in march

yield_factors %>% 
  mutate(date= date(date), year = year(date), bi_pct = central_bank/tot_ownership, con_pct = con_bank/tot_ownership, islam_pct = islam_bank/tot_ownership, ind_pct = individual/tot_ownership, foreign_pct = foreign/tot_ownership) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = foreign_pct)) + 
  facet_wrap(~ year)

## insurance and pension fund strongly positive correlation
yield_factors %>% 
  mutate(date= date(date), year = year(date), bi_pct = central_bank/tot_ownership, con_pct = con_bank/tot_ownership, islam_pct = islam_bank/tot_ownership, ind_pct = individual/tot_ownership, ins_pct = ins_pension/tot_ownership) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = ins_pct)) + 
  facet_wrap(~ year)

yield_factors %>% 
  mutate(date= date(date), year = year(date), bi_pct = central_bank/tot_ownership, con_pct = con_bank/tot_ownership, islam_pct = islam_bank/tot_ownership, ind_pct = individual/tot_ownership, ins_pct = ins_pension/tot_ownership, other_pct = others/tot_ownership) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = other_pct))+
  facet_wrap(~ year)

yield_factors %>% 
  mutate(date= date(date), year = year(date), bi_pct = central_bank/tot_ownership, con_pct = con_bank/tot_ownership, islam_pct = islam_bank/tot_ownership, ind_pct = individual/tot_ownership, ins_pct = ins_pension/tot_ownership, other_pct = others/tot_ownership, mutual_pct = mutual_fund/tot_ownership) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = mutual_fund))+
  facet_wrap(~ year)

## check ggscatmat
# yield_factors %>% 
#   mutate(year = year(date)) %>% 
#   filter(year == 2020) %>% 
#     select(domestic_10y, cds_5y, ust_10y, central_bank, exchange_mid) %>%
# GGally::ggscatmat()



# 
# yield_factors %>% filter(year == 2018) %>% 
#   mutate(month = month(date)) %>% 
#   group_by(month) %>%   
# ggplot(aes(x = factor(day(date)), y = domestic_10y, color = factor(auction_day), alpha = 0.1))+
#   geom_point()+scale_x_discrete(breaks = seq(1, 31, 4))+
#   geom_hline(data = average_2018, aes(yintercept = mean), alpha = 0.5)+
#   facet_wrap(~month)
# 
# yield_factors %>% filter(year == 2019) %>% 
#   mutate(month = month(date)) %>% 
#   group_by(month) %>%   
# ggplot(aes(x = factor(day(date)), y = domestic_10y, color = factor(auction_day), alpha = 0.1))+
#   geom_point()+scale_x_discrete(breaks = seq(1, 31, 4))+
#   geom_hline(data = average_2019, aes(yintercept = mean), alpha = 0.5)+
#   facet_wrap(~month)
# 
# yield_factors %>% filter(year == 2020) %>% 
#   mutate(month = month(date)) %>% 
#   group_by(month) %>%   
# ggplot(aes(x = factor(day(date)), y = domestic_10y, color = factor(auction_day), alpha = 0.1))+
#   geom_point()+scale_x_discrete(breaks = seq(1, 31, 4))+
#   geom_hline(data = average_2020, aes(yintercept = mean), alpha = 0.5)+
#   facet_wrap(~month)
# 
# yield_factors %>% filter(year == 2021) %>% 
#   mutate(month = month(date)) %>% 
#   group_by(month) %>%   
# ggplot(aes(x = factor(day(date)), y = domestic_10y, color = auction_day, alpha = 0.1))+
#   geom_point()+scale_x_discrete(breaks = seq(1, 31, 4))+
#   geom_hline(data = average_2021, aes(yintercept = mean), alpha = 0.5)+
#   facet_wrap(~month)

# cek <- yield_factors %>% 
#   group_by(auction_day) %>% select(!pre_auction)
#   # mutate(domestic_10y = as.numeric(domestic_10y)) %>% 

# yield_factors %>% mutate(year = year(date)) %>% 
#   filter(year == 2016) %>% 
#   mutate(month = month(date)) %>% 
#   ggplot(aes(y = domestic_10y, color = auction_day)) +
#   geom_boxplot()+facet_wrap(~month)

# cek %>% filter(year == 2017) %>% 
#   mutate(month = month(date)) %>% 
#   ggplot(aes(y = domestic_10y, color = auction_day)) +
#   geom_boxplot()+facet_wrap(~month)
#   
# cek %>% filter(year == 2018) %>% 
#   mutate(month = month(date), date = date(date)) %>% 
#   ggplot(aes(y = domestic_10y, x= factor(date), color = auction_day)) +
#   geom_point()+facet_wrap(~month)
# 
# cek %>% filter(year == 2020) %>% 
#   mutate(month = month(date)) %>% 
#   ggplot(aes(y = domestic_10y, color = auction_day)) +
#   geom_boxplot()+facet_wrap(~month)+theme(legend.position = "bottom")



# yield distribution in each year
# 2018 yield move from low in early year to high in late period of year
# different direction compared to other years

# 2021 yield tend to be restrained in the middle
# yield_factors %>% mutate(year = year(date)) %>% filter(year == 2021) %>%  
#   mutate(month = month(date)) %>% 
#   ggplot(aes(x = domestic_10y, color = auction_day), group = auction_day) +
#   geom_density()+
#                facet_wrap(~ month)


```

As we can see from the plot, in 2015 and 2016 foreign ownership seems to have no strong relationship with the yield. Different situation happened in 2017-2019 where the changes in foreign ownership seems to strong-negatively affect the bonds yield movement. 

To mention, 2017 is the year when Indonesia got investment grade rating from S&P, following FITCH and Moody's in previous years. It means that broader category of foreign investment entities (i.e. pension funds and insurance) can enter the country's market since Indonesia's rating has fulfilled their criteria of investment (yunianto, 2018). 

Particularly In 2020, the pattern is quite anomaly in which increase from 0.25-0.33% in foreign ownership seems to raise the yield from 6 up to 8.5%. The yield stumbles afterwards with the increase of foreign ownership up to 40%. 

In January-August 2021, the relationship looks non-linear with no obvious pattern. The ownership drops below 25% but interestingly yield decreases further (6-7%).

We may assume that the anomaly in 2020 and 2021 are due to Covid19 pandemic that occurred since early 2020. The government is increasing its funding to sustain the economy. The decrease in foreign portion could be because foreigners sell their bonds more than their buying (net sell), or another reason is because their portion is deluged by domestic participants (i.e. central bank), thus we will track the pattern of domestic ownership in these years to check our assumption.

```{r}

#scattermatrix
# yield_factors %>% 
#   filter(year > 2019) %>% 
# GGally::ggscatmat(columns = c(2,3,4,5))

# yield_factors %>% 
#   filter(year > 2019) %>% 
#   mutate(bi_pct = central_bank/tot_ownership, indv_pct = individual/tot_ownership, insp_pct = ins_pension/tot_ownership, mut_pct = mutual_fund/tot_ownership, sec_pct = securities_company/tot_ownership, conv_pct = con_bank/tot_ownership, isl_pct = islam_bank/tot_ownership) %>% 
#   select(domestic_10y, foreign_pct, bi_pct, indv_pct, insp_pct, mut_pct, sec_pct, conv_pct, isl_pct) %>% 
# GGally::ggscatmat()

# yield_factors %>% 
#   filter(year > 2018) %>% 
# GGally::ggscatmat(columns = c(5, 13, 14, 15, 16, 17, 18, 19))

model <- lm(domestic_10y ~ cds_5y + ust_10y + foreign + rate + con_bank, data = yield_factors)

# reduce to "best fit" model with
model_best <- step(model, trace = FALSE)
summary(model)

#diagnose model
ggnostic(model)

```

As shown in the plot, proportion of Bank Indonesia and Conventional Bank are getting bigger in 2020-2021, while proportion of foreign holders is diluted. This is can be seen as a result of implementation of new regulation on 1 May 2020 that mandate banks to reserve government bonds. This regulation has an impact on reducing bonds yield further in these two consecutive years.

Another noticeable change is proportion of individual in the bonds ownership that is growing started from mid of 2020 up to 2021. We may argue that people who prefer to hold their spending is channelling their excess money to investment, especially in a safe instrument like government bonds.

## Policy Rate
```{r eval = FALSE}

# yield_factors %>% 
#   na.omit() %>% 
#   mutate(year = year(date)) %>% 
#    filter(year != 2015) %>% 
#   select(date, domestic_10y, rate, foreign, central_bank) %>%
#   gather(key = "variable", value = "value", -date) %>% 
#   ggplot(aes(x = date, y = log(value)))+
#   geom_smooth(aes(color = variable))+theme_minimal()

## ownership pct
yield_factors %>% 
  na.omit() %>% 
  mutate(date= date(date), year = year(date), bi_pct = central_bank/tot_ownership, con_pct = con_bank/tot_ownership, islam_pct = islam_bank/tot_ownership, ind_pct = individual/tot_ownership, other_pct = others/tot_ownership, mutual_pct = mutual_fund/tot_ownership, ins_pct = ins_pension/tot_ownership, foreign_pct = foreign/tot_ownership) %>% 
   filter(year != 2015) %>% 
  select(date, foreign_pct, bi_pct, con_pct, islam_pct, ind_pct, other_pct, mutual_pct, ins_pct) %>%
  gather(key = "variable", value = "value", -date) %>% 
  ggplot(aes(x = date, y = value))+
  geom_area(aes(fill = variable), alpha = 0.7)+
  theme_classic()

####Others = securities, corporations, and foundations.

# spread pol-rate vs yield
# 2020 spread range between policy rate and yield is quite dispersed
# 2021 spread range is the narrowest
# 
yield_factors %>% 
  na.omit() %>% 
  mutate(year = year(date), spread = abs(domestic_10y-rate)) %>%
  filter(year > 2015) %>% 
  select(date, year, spread, domestic_10y, rate) %>% 
  ggplot(aes(y = spread))+
  geom_boxplot()+
  facet_wrap(~year)


```

From plot above, the movement of domestic 10y yield is parallel with movement of policy rate. The median spread in 2016 until 2018 is quite the same (around 2.5) while median spread of 2019 is the lowest. In 2020 and 2021, the differences between 10y yield and policy rate are increase with median spread is about 3. The range of spread in 2020 is also the widest compared to other observed years.

# Bibliography

