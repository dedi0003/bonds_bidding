---
title: "Determining Factors for 10-year Local Currency Sovereign Bonds (LCB) Yield: Indonesia Case"
author: "Dea Avega Editya"
date: "8/5/2021"
output:
  bookdown::pdf_document2:
    toc_depth: 4
  html_document: default
bibliography: baca.bib  
nocite: |
  @dplyr, @ggplot2, @tidyverse, @tsibble, @tsibbletalk, @gravitas, @readr, @readxl, @stringr, @lubridate, @janitor, @cleaner, @openxlsx, @zoo, @purrr, @sugrrants, @GGally, @scales, @flipTime, @caret, @stargazer, @kableExtra, @lvplot, @ggh4x, @fpp3
---
<style>
body {
text-align: justify}
</style>


```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, dev = 'pdf', warning = FALSE, message = FALSE, out.width = "70%")

library(dplyr)
library(ggplot2)
library(tidyverse)
library(tsibble)
library(tsibbletalk)
library(gravitas)
library(readr)
library(readxl)
library(stringr)
library(lubridate)
library(janitor)
library(cleaner)
library(plotly)
library(openxlsx)
library(zoo)
library(purrr)
library(sugrrants)
library(GGally)
library(scales)
library(flipTime)
library(caret)
library(patchwork)
library(stargazer)
library(kableExtra)
library(forecast)
library(lvplot)
library(ggh4x)
library(urca)
library(fpp3)


#read compiled dataset
yield_factors <- readRDS("yield_factors.rds")

```

\newpage

# Introduction

Indonesian government regularly issue Rupiah-denominated sovereign bonds (conventional and sharia bonds) in the primary market to finance the deficit of the national budget. In 2021, the issuance target for the sovereign bonds is around 80-85% of total deficit financing which amounts to IDR1,006 Trillion or equivalent to USD72 Billion ^[Assumed exchange rate for conversion (IDR/USD) = 14,284.00]. As of 2 September 2021, the total outstanding of local currency sovereign bonds (LCB) is IDR4,539 Trillion or equivalent to USD318 billion ^[ibid]. 

The government sells the sovereign bonds through an auction which is conducted every Tuesday. The announcement will be released three days before the auction day (T-3). During a 2-hour auction, investors (both individuals and institutions) can put their bidding in multiple prices through primary dealers, and auction winners will pay their bonds based on their proposed volumes and yields. In addition to the multiple price (competitive) mechanism, the government also offers LCB to several non-competitive participants such as Indonesia Central Bank (Bank Indonesia) and Indonesia Deposit Insurance Corporation (Lembaga Penjamin Simpanan). This non-competitive buying may also be conducted by primary dealers to complement their competitive bidding purchase. Non-competitive buyers will pay their LCB based on weighted average yield (WAY) from the winning competitive bidding.

There are several benchmark series of LCB offered in the auction. These series represent various maturity times. For conventional bonds, tenors of benchmark series in 2021 are ranging from 5, 10, 15, and 20 years. Meanwhile, benchmark tenors of sharia bonds cover 2, 4, 13, and 25 years.  
  
Since 2021, the yield of 10-year LCB has become one of the macroeconomic assumptions in the national budget, replacing treasury bills of tenor 3-month (Surat Perbendaharaan Negara). This replacement is because the yield of 10-year LCB is deemed as having a larger and more significant portion in the nation's cost of borrowing compared to the T-bills. Moreover, the 10-year yield is also reflecting long-term economic development and its movement is commonly used as a sign for predicting country's economic health. 

During a period of 2014-2018, Indonesia is said to have a higher average of 10-year sovereign bonds yield compared to its ASEAN-5 peers (Thailand, Philippines, Malaysia, Vietnam) as well as several other emerging countries with similar credit ratings like Mexico, Columbia, and India [@Muktiyanto2019]. This condition makes Indonesia pays more expensive debt compared to these countries. As corporate and business use the yield for benchmarking when issuing their LCB as well as lending money, the impact of costly debt is also spilled over in the national economy.

Considering the important functions of the 10-year LCB yield in Indonesia's economy, this study will analyze several variables that determine the yield and quantify their impact using the Ordinary Least Squared (OLS) model. This paper will be delivered in several sections. First, we will explain our research's purpose in Section 2. Section 3 will provide background knowledge from prior studies and explanation of the collected data. Section 4 will focus on exploratory data analysis (EDA) by visualizing data to check any interesting features of the variables. Section 5 and section 6 will cover the research methodology and result of analysis subsequently. The Appendix contains additional information.

# Motivation

This paper provides two new values to existing literature. First, it employs an exploratory data analysis (EDA) approach at the beginning of analysis to gain better intuition of each explanatory variable. This approach is quite important especially for capturing particular data characteristics, i.e. non-linearity before we can proceed to a confirmatory step. Disregarding the data characteristic will result in inappropriate data modeling.
Second, this is the first work that empirically studies the impact of primary dealers' behavior on the 10-year LCB yield in Indonesia.  
The purpose of this work will be to provide insights and policy recommendations for the government in reducing LCB yield, particularly by aiming at significant determinant factors, which in turn help to optimize the national's cost of borrowing. 


# Explanation of Collected Data

There are 7 variables used in this paper as explanatory variables to the Indonesia's LCB yield; US Treasury (UST) yield, Credit Default Swap (CDS), foreign ownership (%), central bank's policy rate (policy rate), exchange rate, volatility index (VIX) and a dummy variable of auction/non-auction days as a proxy to primary dealers' trading behavior. The use of these explanatory variables are following numerous studies that have been conducted previously by various authors.  

The UST yield is said by [@Miyajima2015] and [@Muktiyanto2019] to be significantly affecting bonds yield. Miyajima et al. [-@Miyajima2015] conclude that the UST yield, while not a main contributor to the LCB yield in the emerging economies, is to some extent affecting the yield. Muktiyanto et al. whose focus of study is on Indonesia's bonds gives more emphasize on the predictor variable suggesting that the UST yield is not only significant but also has the biggest role in determining the LCB yield of the country. On the contrary, Permanasari et al. [-@Permanasari2021] who also study the same country suggest that the UST yield has no significant effect in determining the LCB yield.

Furthermore, Kim et. al [-@Kim2014] and Muktiyanto et al. [-@Muktiyanto2019] find that Credit Default Swap (CDS) is a significant factor that affecting the yield. The first name, using yield spread decomposition approach, suggest that the CDS as a proxy to default risk has 37% contribution to the spread. Muktiyanto et al. [@Muktiyanto2019] support this finding by suggesting the significant effect of the CDS on the Indonesia's LCB yield.

The effect of foreign ownership on the bonds yield is studied by researchers like Gadanecz et al. [-@Gadanecz2018] who confirm the significance of the variable in LCB market. Another study with similar tone by Dachroui et al. [@Dachraoui2020] who analyze role of capital flight as a driver of sovereign bonds spreads in Latin American countries, conclude that the spreads are positively correlated with the capital flight [-@Dachraoui2020]. 

Our fourth predictor variables used in this study, the policy rate, is inspired by findings from several works in Indonesia conducted by Muktiyanto et al. [-@Muktiyanto2019] and Kurniasih et al. [-@Kurniasih2015] These authors analyze relationship between the predictor with Indonesia's bonds yield. Both studies agree that the policy rate significantly affect the yield in a positive direction.     

Moreover, some works highlight the effect of exchange rate on the bonds yield [@Miyajima2015], [@Gadanecz2018], [@Saenong2020] and [@Permanasari2021]. Miyajima et al. [-@Miyajima2015] suggest crucial effect of the exchange rate on the yield in emerging economies, while Gadanecz et al [@Gadanecz2018] using exchange rate volatility and expected exchange rate as predictor variables also confirm the significant relationship. These two studies are inline with a work by Permanasari et al. [-@Permanasari2021] who study the effect on Indonesia's bonds yield, suggesting significant negative-relationship between the exchange rate and the yield. A slight different conclusion is provided by Saenong et al [@Saenong2020] who argue that the effect on the Indonesia's bonds yield only significant in the short run but find to be insignificant in the long run.

Meanwhile, relationship between our sixth predictor-the VIX and the bonds yield is said to be significant by several researchers like [@Miyajima2015], [@Izadi2018], and [@Dachraoui2020]. Miyajima find the significant relationship in several emerging market being observed, while Izadi et al. [@Izadi2018] also find the similar effect in all 24 developed countries in
North America, Europe and Pacific Rim regions. In addition, Dachraoui [-@Dachraoui2020] confirm the significant effect in Latin America.

Other researches like Tchuindjo et al.[-@Tchuindjo2015], Endo [-@Endo2020], Nyborg et al. [-@Nyborg2004], Mercer et al. [-@Mercer2013], and Ferrari et al. [-@Ferrari2018] took different angle by looking at primary dealers system and its impact on bonds yield. Endo [-@Endo2020] study role of primary dealers in low income economies, while Ferrari et al. [-@Ferrari2018] focus on primary dealers' funding constraints on sovereign bonds yield. Nyborg et al. [-@Nyborg2004], Mercer et al. [-@Mercer2013] and Tchuindjo [-@Tchuindjo2015] concern on primary dealers trading behavior in US Treasury auction. The last name also provide several mathematical models to estimate the impact of primary dealers' strategic behavior in the auction [-@Tchuindjo2015].

For the purpose of our study, we will use 10-year US Treasury (UST) yield, 5-year Indonesia's Credit Default Swap (CDS), foreign ownership in Indonesia's 10-year bonds (%), Bank Indonesia's policy rate, exchange rate (IDR/USD), Indonesia's volatility index (VIX) as well as a dummy variable of Indonesian government auction days as a proxy of Indonesia's primary dealers' behavior. Our response variable is the 10-year Indonesia's LCB yield. All variables (except for Bank Indonesia's policy rate ^[The Bank Indonesia's policy rate is only available from 21 April 2016]) are collected as time-series data covering period from 2 January 2015 up to 5 August 2021 and can be described as follow: 

<!-- Gadanecz et al. [-@Gadanecz2018] plays important role as stabilizing force of exchange rate volatility.  -->

## 10-year LCB Yield  

Yield can be described as expected return demanded by investors in exchange of borne risks. The 10-year LCB yield data used in this study is using Indonesia's generic yield of 10-year maturity as a proxy to the LCB yield. The data is retrieved from Bloomberg platform using ticker code "GRR" (global summary of government bill, note, and benchmark bond rates for individual countries). 

```{r}
yield_ts <- readRDS("yield_ts.rds")

####scaling variables
yieldts_scale <- yield_ts %>% as_tibble() %>% 
  mutate(for_pct = foreign/tot_ownership) %>% 
  select_if(is.numeric) %>% 
  scale()

yieldts_scale <- cbind(as_tibble(yield_ts$date), yieldts_scale) %>% rename(date = value)

```

```{r warning = FALSE, message = FALSE, include = FALSE}

## search harmony
# harmony <- harmony(yield_ts)
```

Timeseries visualization of the LCB yield can be seen in figure \@ref(fig:lcb). As shown in the plot, the general trend of the yield is decreasing over the period of observations.

```{r lcb, out.width= "70%", fig.cap = "10y-LCB Yield Movement from Jan 2015 until Aug 2021", fig.align='center'}
##yield movement
 yield_ts %>%
  ggplot(aes(x = date, y = domestic_10y))+
   geom_line(color = "darkgreen", size = 1)+theme_light()+
   ylab("10y-LCB yield")
```

If we look at the annual seasonal plot of the LCB yield at figure \@ref(fig:lcbseason), we see that 2015 and 2018 have a quite similar increasing trend, while 2017 and 2019 have a similar decreasing trend. 

```{r lcbseason, fig.cap = "Seasonal Plot of 10y-LCB Yield", fig.align='center'}

## seasonal plot
## yield_fc use full date in a year, while yield_ts use original date from dataset
yield_fc <- readRDS("yield_fc.rds") %>% 
  as_tsibble(index = date)

yield_fc %>% mutate(quarter = yearquarter(date)) %>% 
gg_season(domestic_10y, size=1)+
  ylab("LCB yield")+theme_light()

```

Looking further to the probability distribution of the yield-divided by year, semester and week in month as shown in figure \@ref(fig:lcbprob), we can see that the yield is generally more volatile in the first semester (as indicated by longer interquartile ranges) than the second semester with exception for 2020. 


```{r lcbprob, fig.cap = "Probability Distribution of 10y-LCB Yield yield by Semester-Week in Month", warning = FALSE, message = FALSE, fig.width = 12, fig.height = 8, fig.align='center'}
# semester yield 10y
yield_ts %>%
  select(date, domestic_10y, auction_day) %>% 
  create_gran("quarter_semester") %>% 
  create_gran("week_month") %>% 
  ggplot(aes(x = week_month, y = domestic_10y)) +
  geom_boxplot()+
  facet_wrap(~ year(date) + quarter_semester, scales = "free")+
  ylab("Yield")+xlab("Week Month")+theme_light()
            
## Result:
## Yield volatility is intense (shown by long interquartile) in semester 2, distinct to other years (exc 2019, 2020).
#2017 and 2019 have higher median in semester 1, others have higher median in sem 2.
```



Furthermore, as yield is associated with risks, we will group our explanatory variables based on several relevant risk categories, which are external risk, default risk, financial market risk, macroeconomic risk and system risk.


## External Risk  

### 10-year US Treasury Yield

The United States of America government's bonds (UST bonds) is generally used as a benchmark for other countries' sovereign bonds. The bonds is considered as the safest instrument hence issuers from other countries will give extra premium over the UST bonds yield in order to compensate additional risks taken by investors for purchasing non-UST bonds.
The UST yield data used in this study is sourced from Bloomberg with the same ticker code "GRR" for the 10-year maturity government bonds of the United State of America. Timeseries visualization of the predictor variable is shown in figure \@ref(fig:usts). The general trend of the UST yield is decreasing.


```{r usts, out.width= "70%", fig.cap = "10y-UST Yield Movement from Jan 2015 until Aug 2021", fig.align='center'}
##UST yield movement
 yield_ts %>%
  mutate(foreign_prop = foreign/tot_ownership) %>%
  mutate(cum_foreign = cumsum(foreign_prop)) %>%
  ggplot(aes(x = date, y = ust_10y))+
   geom_line(color = "darkgreen", size = 1)+theme_light()+
   ylab("10y-UST yield")
```

Moreover, timeseries of the predictor and the 10y-LCB yield with adjusted scale can be seen in figure \@ref(fig:lcbust). From the figure, we may conclude that these two variables seem to move toward the same direction, except for 2020 in which both variables were obviously moving in the opposite way.

```{r lcbust, fig.cap = "Timeseries of 10y-LCB Yield and 10y-UST yield (Adjusted Scale)", warning = FALSE, message = FALSE, fig.width = 12, fig.height = 8, fig.align='center'}

# create multivariate lines of timeseries
# gatherscale <- yieldts_scale %>%
#   select(date, domestic_10y, ust_10y, cds_5y, vix, exchange_mid, for_pct, rate) %>%
#   gather(key = "variable", value = "value", -date)
# 
# gatherscale$variable <- factor(gatherscale$variable, levels = c("domestic_10y", "ust_10y", "cds_5y", "vix", "for_pct", "exchange_mid", "rate"))
# 
# gatherscale %>%
#   ggplot(aes(x = date, y = value))+
#   geom_line(aes(color = variable))+
#   facet_wrap(~ year(date), scale = "free")+
#   ggtitle("Timeseries of Response and Predictor Variables")+
#   theme(legend.position = "bottom")

# LCB and UST yield
yieldts_scale %>% 
  ggplot(aes(x = date))+
  geom_line(aes(y = domestic_10y, color = "red") , size = 1)+
  geom_line(aes(y = ust_10y, color = "darkgreen"), size = 1)+
  facet_wrap(~ year(date), scale = "free")+
   scale_color_discrete(name = "Variable", labels = c("10y-UST yield", "10y-LCB Yield"))+
  ylab("value")+
  theme_light()+theme(legend.position = "bottom")+scale_x_date(labels = date_format("%b"))

```


Looking at the annual seasonal plot of the UST yield at figure \@ref(fig:ustseason), we see that all years before 2019 have a relatively stable trend. 

```{r ustseason, fig.cap = "Seasonal Plot of 10y-UST Yield", fig.align='center'}

## seasonal plot
## yield_fc use full date in a year, while yield_ts use original date from dataset

yield_fc %>% 
gg_season(ust_10y, size=1)+
  ylab("UST yield")+theme_light()

```


Probability distribution of 10y-UST yield for all years in observation is illustrated in figure \@ref(fig:ustprob). In most years, the distribution is equal between first and second semester. Particularly for 2018, the UST yield looks more volative in the first semester than the second one. The opposite case is occurred in 2020, where the volatility is higher in the second semester than the first one. 

```{r ustprob, fig.cap= "Probability Distribution of 10y-UST yield by Semester-Week in Month", message = FALSE, warning = FALSE, fig.width = 12, fig.height = 8, fig.align='center'}
# semester ust 10y
yield_ts %>%
  select(date, ust_10y, auction_day) %>% 
  create_gran("quarter_semester") %>% 
  create_gran("week_month") %>% 
  ggplot(aes(x = week_month, y = ust_10y)) +
  geom_boxplot()+
  facet_wrap(~ year(date) + quarter_semester, scales = "free")+
  ylab("10y-UST yield")+xlab("week month")+theme_light()
```

The yearly correlation between the 10y-UST yield and the 10y- lCB yield is shown in figure \@ref(fig:lcbustcor). The plot indicates a positive linear correlation between the two variables in all observed years, except for 2020 that suggests a negative correlation.

```{r lcbustcor, fig.cap= "Correlation between 10y-UST Yield and 10y-LCB Yield", fig.align='center'}
yield_factors %>% 
  mutate(week_year = yearweek(date), year = year(date), foreign_chg = foreign/tot_ownership) %>% 
  ggplot(aes(x = ust_10y, y = domestic_10y)) + 
  geom_point(alpha = 0.3)+facet_wrap(~ year, scale = "free")+theme_light()+ylab("10y-LCB Yield")+xlab("10y-UST yield")
```

### Foreign Ownership

As per 29 July 2021, foreign investors are holding IDR965 Trillions or 22.5% of total bonds ownership. The historical data of changes in the foreign ownership is shown in figure \@ref(fig:forts). The general trend of the changes is increasing.

```{r}
yield_foreign <- yield_ts %>% 
  mutate(foreign_prop = foreign/tot_ownership) %>%
  mutate(cum_foreign = cumsum(foreign_prop))
```
  
```{r forts, out.width= "70%", fig.cap = "Changes in Foreign Ownership from Jan 2015-Aug 2021", fig.align='center'}
yield_foreign %>% 
  ggplot(aes(x = date, y = foreign))+
  geom_line(size = 1, color = "darkgreen")+theme_light()+ylab("foreign ownership (Trillion Rupiah)")

```
  

If we look at the annual seasonal plot of the foreign ownership (%) at figure \@ref(fig:forseason), we see that all years have a relatively stable trend, with exception for 2020 and 2021 in which the proportion of foreigners were declining.  

```{r forseason, fig.cap = "Seasonal Plot of Foreign Ownership Portion", fig.align='center'}

## seasonal plot
## yield_fc use full date in a year, while yield_ts use original date from dataset

yield_fc %>% mutate(quarter = yearquarter(date), for_pct = foreign/tot_ownership) %>% 
gg_season(for_pct, size=1)+
  ylab("Foreign ownership (%)")+theme_light()

```  
  
Probability distribution of the ownership for all years of observation is shown in figure \@ref(fig:forprob). In general, the changes in ownership is more volatile in first semester than the second one. It may be related to the timing of investment decision that usually more active in the early phase of year.  

```{r forprob, fig.cap="Probability Distribution of Foreign Ownership", message = FALSE, warning = FALSE, fig.width = 12, fig.height = 8, fig.align='center'}
# semester 
yield_ts %>% as_tsibble() %>% 
 mutate(foreign_pct = foreign/tot_ownership) %>% 
  select(date, foreign_pct, auction_day) %>% 
  create_gran("quarter_semester") %>% 
  create_gran("week_month") %>% 
  ggplot(aes(x = week_month, y = foreign_pct)) +
  geom_boxplot()+
  facet_wrap(~ year(date) + quarter_semester, scales = "free")+
  ylab("Foreign Pct")+xlab("Week Month")+theme_light()

```
  
The foreign investor's share in the government bonds (including the 10y-LCB) has been reduced dramatically since 2020 due to an increase in both central bank and conventional bank's holdings in the LCB, as shown in figure \@ref(fig:ownprop). The figure shows daily changes in the LCB ownership, grouped by several industries from Jan 2018 until early August of 2021 (data before 2018 is not shown in the plot since it has different classification names for the industries).  


```{r ownprop, out.width= "70%", fig.cap="Total Proportion of Bonds Ownership by Industry from Jan 2015-Aug 2021", fig.align='center'}
## total ownership in Indo LCB bonds
# yield_ts %>% as_tibble() %>% 
#   na.omit() %>% 
#   mutate(date= date(date), year = year(date), bi_pct = central_bank/tot_ownership, con_pct = con_bank/tot_ownership, islam_pct = islam_bank/tot_ownership, ind_pct = individual/tot_ownership, other_pct = others/tot_ownership, mutual_pct = mutual_fund/tot_ownership, ins_pct = ins_pension/tot_ownership, foreign_pct = foreign/tot_ownership) %>% 
#    # filter(year != 2015) %>% 
#   select(date, foreign_pct, bi_pct, con_pct, islam_pct, ind_pct, other_pct, mutual_pct, ins_pct) %>%
#   gather(key = "variable", value = "value", -date) %>% 
#   ggplot(aes(x = date, y = value))+
#   geom_line(aes(fill = variable), size = 1, alpha = 1)+facet_wrap(~ variable)+
#   theme_bw()

yield_ts %>% as_tibble() %>% 
  na.omit() %>% 
  mutate(date= date(date), year = year(date), bi_pct = central_bank/tot_ownership, con_pct = con_bank/tot_ownership, islam_pct = islam_bank/tot_ownership, ind_pct = individual/tot_ownership, other_pct = others/tot_ownership, mutual_pct = mutual_fund/tot_ownership, ins_pct = ins_pension/tot_ownership, foreign_pct = foreign/tot_ownership) %>% 
   # filter(year != 2015) %>% 
  select(date, foreign, central_bank, con_bank, islam_bank, ins_pension, individual, others, mutual_fund) %>%
  rename(conventional_bank = con_bank, islamic_bank = islam_bank, insurance_pension = ins_pension) %>% 
  gather(key = "variable", value = "value", -date) %>% 
  ggplot(aes(x = date, y = value))+
  geom_line(aes(fill = variable, color = variable), size = 1, alpha = 1)+
  ylab("Trillion IDR")+
  # facet_wrap(~ variable)+
  theme_light()
```
  
Starting from mid of 2020, the Central Bank (Bank Indonesia) seems to move aggressively in purchasing the government bonds through Quantitative Easing (QE) program in order to absorb larger issuance of the bonds which aimed to support large financing for covid19 pandemic. The monetary authority also introduced mandatory purchase regulation for the conventional banks that requires them to buy some minimum amount of the bonds and hold it as their liquidity assets, thus the bank's ownership were also growing big and even exceed the foreign ownership.

Timeseries of the foreign ownership and the yield is visualized in figure \@ref(fig:lcbfor). From the figure we can see that most of the time these two variables are moving in opposite direction, except for 2020.  


```{r lcbfor, fig.cap="Timeseries of 10y-LCB Yield and Foreign Percentage (Adjusted Scale)", fig.width = 12, fig.height = 8, fig.align='center'}
# LCB and Foreign
yieldts_scale %>%
  ggplot(aes(x = date))+
  geom_line(aes(y = domestic_10y, color = "red") , size = 1)+
  geom_line(aes(y = foreign, color = "darkgreen"), size = 1)+
  facet_wrap(~ year(date), scale = "free")+
   scale_color_discrete(name = "Variable", labels = c("Foreign Pct", "10y-LCB Yield"))+
  ylab("value")+
  theme_light()+theme(legend.position = "bottom")+scale_x_date(labels = date_format("%b"))
```
  
  

The yearly correlation between the foreign ownership and the 10y-LCB yield can be seen in figure \@ref(fig:corfor). In general, the plot shows negative correlation between these two variables, except for 2020 in which foreigner's dominant holding of the LCB was mainly reduced by the increase of conventional banks and the central bank's holdings. Thus, despite a decrease in the foreigner's portion, the yield was kept lowered since the banks and the central bank increased their holdings.  


```{r corfor, fig.cap= "Correlation between Foreign Ownership and 10y-LCB Yield", message = FALSE, warning = FALSE, fig.align='center'}
#foreign changes
## negative relationship when foreign pct > 35%, < 35% positive relationship
### due to quantitative easing of central bank 2020-2021 and mandatory purchase of domestic banks boost domestic ownership

yield_ts %>% 
  mutate(week_year = yearweek(date), year = year(date)) %>% 
  ggplot(aes(x = foreign, y = domestic_10y)) + 
  geom_point(alpha = 0.3) + 
  facet_wrap(~ year, scale = "free") +
  theme_light()+ylab("10y-LCB Yield")+xlab("Foreign Ownership")

```


## Default Risk (5-year Credit Default Swap) 

A credit default swap (CDS) is a derivative contract that allows investors to hedge against the default of a borrower. This provides a market-based measure of the credit-risk premium. As mentioned by Codogno et al. [-@Codogno2003], CDS spreads can be seen as indication of the perceived credit risk by investors. This study uses data of Indonesia's 5y-CDS which is gathered from Bloomberg platform.

Timeseries of the CDS can be seen in figure \@ref(fig:cdsts). The general trend of the CDS is declining, with the highest jump occurred in early 2020 due to announcement of early cases of covid19 in March 2020.

```{r cdsts, out.width= "70%", fig.cap="Indonesia's 5y-CDS from Jan 2015-Aug 2021", fig.align='center'}
yield_ts %>% 
  ggplot(aes(x = date, y = cds_5y))+
  geom_line(size = 1, color = "darkgreen")+theme_light()+ylab("5y-CDS")
```

Checking at the annual seasonal plot of the 5y-CDS at figure \@ref(fig:cdsseason), we see that the observed trends are quite the same with the trend of the LCB yield, in which 2015 and 2018 have an increasing trend, whereas 2017 and 2019 have a decreasing trend. 

```{r cdsseason, fig.cap = "Seasonal Plot of 5y-CDS", fig.align='center'}

## seasonal plot
## yield_fc use full date in a year, while yield_ts use original date from dataset

yield_fc %>% mutate(quarter = yearquarter(date)) %>% 
gg_season(cds_5y, size=1)+
  ylab("CDS")+theme_light()

```  

Probability distribution of the CDS is shown in figure \@ref(fig:cdsprob). There is no obvious different between first and second semester for each year of observation, except for 2020 in which the CDS looks more highly volatile in the second semester than the first one. In addition, the first semester of 2020 has some noticeable outliers, with the highest value is about 300.

```{r cdsprob, fig.cap = "Probability Distribution of 5y-CDS by Semester-Week in Month", warning = FALSE, message = FALSE, fig.width = 12, fig.height = 8, fig.align='center'}
# semester cds 5y
yield_ts %>% 
 mutate(foreign_pct = foreign/tot_ownership) %>% 
  select(date, cds_5y, auction_day) %>% 
  create_gran("quarter_semester") %>% 
  create_gran("week_month") %>% 
  ggplot(aes(x = week_month, y = cds_5y)) +
  geom_boxplot()+
  facet_wrap(~ year(date) + quarter_semester, scales = "free")+
  ylab("Foreign Pct")+xlab("Week Month")+theme_light()
```


Timeseries of the CDS and the yield can be seen in figure \@ref(fig:lcbcds). From the visualization we can see that the pattern of these two variables are really similar, and both are moving towards the same direction.

```{r lcbcds, fig.cap = "Timeseries of 10y-LCB Yield and 5y-CDS (Adjusted Scale)", fig.width = 12, fig.height = 8, fig.align='center'}
# LCB and CDS
yieldts_scale %>% 
  ggplot(aes(x = date))+
  geom_line(aes(y = domestic_10y, color = "red") , size = 1)+
  geom_line(aes(y = cds_5y, color = "darkgreen"), size = 1)+
  facet_wrap(~ year(date), scale = "free")+
   scale_color_discrete(name = "Variable", labels = c("5y-CDS", "10y-LCB Yield"))+
  ylab("value")+
  theme_light() + theme(legend.position = "bottom")+scale_x_date(labels = date_format("%b"))


```

The yearly correlation between the CDS and the yield is shown in figure \@ref(fig:corcds). The plot shows strong relationship between the two variables in all observed years.

```{r corcds, fig.cap= "Correlation between 5y-CDS and 10y-LCB Yield", warning = FALSE, message = FALSE, fig.align='center'}
###cds vs yield 
yield_ts %>%
  mutate(year = year(date)) %>%
  mutate(date= date(date), month =  month(date), spread_10 = cds_10y-domestic_10y, spread_5 = cds_5y-domestic_10y, spread_ust = domestic_10y-ust_10y, spread_bi = domestic_10y-rate, ust_bi = rate-ust_10y) %>%
  ggplot(aes(x = cds_5y, y = domestic_10y))+
  geom_jitter(alpha = 0.3)+
  facet_wrap(~year,  scale = "free")+theme_light()+ylab("10y-LCB yield")+xlab("5y-CDS")
```


## Financial Market Risk  

### Volatility Index  

Volatility Index-a shorter term for Chicago Board Options Exchange's (CBOE) Volatility Index, was first introduced by the CBOE to measure the relative strength of short-term price changes of the S&P 500 index (SPX) in real-time. One of the main purposes of the VIX Index as suggested by Whaley [-@Whaley2009] is it can be used to quantify expected short-term volatility and to track historical volatility using index option prices. Moreover, the index is practically used by investors to measure shock/fear in a stock market, thus it is also known as Fear Index. 

After successful implementation in the USA, the index is now used globally to quantify the volatility of country's stock market. Data of Indonesia's VIX Index used in this study is retrieved from Bloomberg platform.

Historical VIX of the country can be seen in figure \@ref(fig:vixts). During years of observation, the highest jump in the VIX was happened in early 2020 where Indonesia reported its covid19 cases for the first time. 

```{r vixts,out.width= "70%", fig.cap="Volatility Index of Indonesia from Jan 2015-Aug 2021", fig.align='center'}
yield_ts %>% 
  ggplot(aes(x = date, y = vix))+
  geom_line(size = 1, color = "darkgreen")+theme_bw()+ylab("VIX")
```

Reviewing the annual seasonal plot of the VIX at figure \@ref(fig:vixseason), we see that the all years show a relatively stable trend with exception for 2020 that showing a huge leap in March.

```{r vixseason, fig.cap = "Seasonal Plot of VIX", fig.align='center'}

## seasonal plot
## yield_fc use full date in a year, while yield_ts use original date from dataset

yield_fc %>% mutate(quarter = yearquarter(date)) %>% 
gg_season(vix, size=1)+
  ylab("VIX")+theme_light()

```  

The probability distribution of VIX as visualized in figure \@ref(fig:vixprob) shows no significant different between VIX in first and second semester of each year of observation, except for 2016 in which the volatility of VIX in first semester is much higher than the second semester.

```{r vixprob, fig.cap= "Probability Distribution of VIX by Semester-Week in Month", message = FALSE, warning = FALSE, fig.width = 12, fig.height = 8, fig.align='center'}
##VIX
# semester 
yield_ts %>% 
 mutate(foreign_pct = foreign/tot_ownership) %>% 
  select(date, vix, auction_day) %>% 
  create_gran("quarter_semester") %>% 
  create_gran("week_month") %>% 
  ggplot(aes(x = week_month, y = vix)) +
  geom_boxplot()+
  facet_wrap(~ year(date) + quarter_semester, scales = "free")+
  ylab("VIX")+xlab("Week Month")+theme_light()

```

From figure \@ref(fig:lcbvix), the two variables seem to move towards the same direction in all years of observation. One noticeable difference is that the VIX looks more volatile than the yield.

```{r lcbvix, fig.cap = "Timeseries of 10y-LCB Yield and VIX (Adjusted Scale)",fig.width = 12, fig.height = 8, fig.align='center'}
# LCB and VIX yield
yieldts_scale %>% 
  ggplot(aes(x = date))+
  geom_line(aes(y = domestic_10y, color = "red") , size = 1)+
  geom_line(aes(y = vix, color = "darkgreen"), size = 1)+
  facet_wrap(~ year(date), scale = "free")+
   scale_color_discrete(name = "Variable", labels = c("VIX", "10y-LCB Yield"))+
  ylab("value")+
  theme_light()+theme(legend.position = "bottom")+scale_x_date(labels = date_format("%b"))
```



The yearly correlation between the VIX and the yield is shown in figure \@ref(fig:corvix). The plot shows a **non-linear relationship** between the two variables in all observed years. Thus, we will introduce a quadratic term to the VIX variable to handle this issue in our linear model.

```{r corvix, fig.cap= "Correlation between VIX and 10y-LCB Yield", warning = FALSE, message = FALSE, fig.align='center'}
#check volatility vs yield
yield_ts %>% mutate(year = year(date)) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = vix), alpha = 0.5) +
  facet_wrap(~ year, scale = "free") + 
  theme_light()+ylab("10y-LCB Yield") + xlab("VIX")

```
  
### Policy Rate

Policy rate is a product of monetary authority that used as a tool to manage liquidity in money market. The ultimate aim of the policy rate is helping the authority to achieve their inflation target. In Indonesia, the rate is periodically announce to public by Bank Indonesia (BI) as an output of monthly BI Board of Governors' meeting. As explained by Muktiyanto [-@Muktiyanto2019], the rate is expected to be transmissioned in money market, which in turn can affect deposit and loan rate, and finally influence asset valuation including stocks and bonds. Before 19 August 2016, the rate used 12-month BI certificate as a reference rate, and after the date it uses 7-day Reverse Repo Rate (7d-RRR) as a new reference rate.  

Since historical data of the 12-month BI certificate is no longer available in the BI's website, this study is only collecting data of the 7d-RRR which has been officially existed since 21 April 2016. Thus, the data of the policy rate^[The data is downloaded from Bank Indonesia's website at https://www.bi.go.id/id/statistik/indikator/bi-7day-rr.aspx.] used in this study will be ranging from that date until 5 August 2021. 

Historical data of the rate is visualized in figure \@ref(fig:rate). The general trend of the rate is declining.

```{r rate,out.width= "70%", fig.cap="Changes in Policy Rate from Jan 2015-Aug 2021", fig.align='center', fig.keep='high'}
yield_ts %>% 
  ggplot(aes(x = date, y = rate))+
  geom_line(size = 1, color = "darkgreen")+theme_light()+ylab("rate (%)")
```


Figure \@ref(fig:corrate) indicates that the correlation between the policy rate and the yield are mostly positive and linear, with exception for 2020 in which the correlation looks non-linear, and for 2021 the correlation looks linear but negative.  

```{r corrate, fig.cap= "Correlation between Policy Rate and 10y-LCB Yield", warning = FALSE, message = FALSE, fig.align='center'}
#check rate vs yield
yield_ts %>% 
  mutate(year = year(date)) %>% 
  filter(year > 2015) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = rate), alpha = 0.5) +
  facet_wrap(~ year, scale = "free") + theme_light()+ylab("10y-LCB yield") + xlab("policy rate")

```


Timeseries of the rate and the yield for each year of observation can be seen in figure \@ref(fig:lcbrate). The visualization indicates that these two variables are mostly moving towards the same direction, with the most obvious parallel patterns are as shown in 2018 and 2019.

```{r lcbrate, fig.cap="Timeseries of 10y-LCB Yield and Policy Rate (Adjusted Scale)", fig.align='center'}
# LCB and Rate yield
yieldts_scale %>% 
  filter(year(date) > 2015) %>% 
  ggplot(aes(x = date))+
  geom_line(aes(y = domestic_10y, color = "red") , size = 1)+
  geom_line(aes(y = rate, color = "darkgreen"), size = 1)+
  facet_wrap(~ year(date), scale = "free")+
   scale_color_discrete(name = "Variable", labels = c("policy rate", "10y-LCB yield"))+
  ylab("value")+
  theme_light()+theme(legend.position = "bottom")+scale_x_date(labels = date_format("%b"))
```


## Macroeconomic Risk (Exchange Rate USD/IDR)  

The data for foreign exchange (fx) rate of USD against Rupiah is using middle rate, calculated from Bank Indonesia's buy and sell fx rates of each working day ^[The foreign exchange data can be downloaded at https://www.bi.go.id/en/statistik/informasi-kurs/transaksi-bi/Default.aspx]. For non-working days, data is imputed from the rate of a previous working day.

Historical data of the exchange rate is visualized in figure \@ref(fig:fxts). The general trend of the exchange rate is increasing.

```{r fxts, fig.cap="Foreign Exchange Rate USD/IDR from Jan 2015 until Aug 2021", out.width="70%", fig.keep='high', fig.align='center'}
yield_ts %>% 
  # mutate(year = year(date)) %>% 
  # filter(year > 2015) %>% 
  ggplot(aes(x = date, y = exchange_mid))+
  geom_line(size = 1, color = "darkgreen")+theme_light()+ylab("FX rate")
```

Looking at the annual seasonal plot of the exchange rate at figure \@ref(fig:fxseason), we see that 2015 and 2018 have an increasing trend. On the other hand, 2020 has the lumpiest trend with a big jump around March-April. The rest of years seems to have a relatively stable trend. 

```{r fxseason, fig.cap = "Seasonal Plot of Exchange Rate USD/IDR", fig.align='center'}

## seasonal plot
## yield_fc use full date in a year, while yield_ts use original date from dataset

yield_fc %>% mutate(quarter = yearquarter(date)) %>% 
gg_season(exchange_mid, size=1)+
  ylab("FX rate")+theme_light()

```  

Probability distribution of the exchange rate can be seen in figure \@ref(fig:fxprob). In the figure, we can conclude that the exchange rate is relatively more volatile in first semester than second semester in most of years, with an exception for 2017 which shows the opposite. 

```{r fxprob, fig.cap = "Probability Distribution of Exchange Rate by Semester-Week in Month", warning = FALSE, message = FALSE, fig.width = 12, fig.height = 8, fig.align='center'}
## Exchange rate
yield_ts %>% 
 mutate(foreign_pct = foreign/tot_ownership) %>% 
  select(date, exchange_mid, auction_day) %>% 
  create_gran("quarter_semester") %>% 
  create_gran("week_month") %>% 
  ggplot(aes(x = week_month, y = exchange_mid)) +
  geom_boxplot()+
  facet_wrap(~ year(date) + quarter_semester, scales = "free")+
  ylab("Foreign Pct")+xlab("Week Month")+theme_light()

```

Adjusting the scale of variables of LCB yield and Exchange Rate, we visualize the movement of these variables for each year as seen in figure \@ref(fig:lcbfx). From the figure, we may conclude that both variables seem to move toward the same direction. Particularly in 2015, 2016, 2018, 2020 and 2021, these two variables were almost perfectly moving in such a parallel way.  

```{r lcbfx, fig.cap="Timeseries of 10y-LCB Yield and FX USD/IDR (Adjusted Scale)", fig.width = 12, fig.height = 8, fig.align='center'}
# LCB and FX yield
yieldts_scale %>% 
  ggplot(aes(x = date))+
  geom_line(aes(y = domestic_10y, color = "red") , size = 1)+
  geom_line(aes(y = exchange_mid, color = "darkgreen"), size = 1)+
  facet_wrap(~ year(date), scale = "free")+
   scale_color_discrete(name = "Variable", labels = c("FX USD/IDR", "10y-LCB Yield"))+
  ylab("value")+
  theme_light()+theme(legend.position = "bottom")+scale_x_date(labels = date_format("%b"))
```

The yearly correlation between the exchange rate and the yield is shown in figure \@ref(fig:corfx). The plot shows a strong positive relationship between the two variables in all observed years, except for 2017 which has a quite different pattern. For 2018, the relationship between these two indeed looks perfectly linear.

```{r corfx, fig.cap= "Relationship between Exchange Rate and 10y-LCB Yield", fig.align='center'}
#check exchange rate vs yield
# strong and steady positive relationship between exchange rate and yield
# Rupiah weakened yield goes up
yield_ts %>% mutate(year = year(date)) %>% 
  ggplot(aes(y = domestic_10y)) + 
  geom_point(aes(x = exchange_mid)) +
  facet_wrap(~year, scale = "free")+
  theme_light()+ylab("10y Yield") + xlab("Exchange Rate (USD/IDR)")
```

## System Risk (Primary Dealers Behavior) 

Primary dealers system in Indonesia has been established since 2007. The system is expected to run several functions as shown in more developed economies. Arnone and Arden [-@Arnone2003] describe role of primary dealers as intermediary between debt managers and investors in primary market, bookmakers and bonds distributors, liquidity provider between primary and secondary market, promoter of continuous market and efficient price discovery, and adviser to government.

In 2021, there are 20 primary dealers of conventional bonds comprise of 16 conventional banks and 4 securities companies. For sharia bonds, there are also 20 primary dealers consist of 13 conventional banks, 3 Islamic banks and 4 securities companies. Primary dealers are required to participate in every auction and to bid for a minimum quantity of the total offering amount. They can bid both on behalf of their customers and for their own accounts. As primary dealers can participate in competitive bidding in primary market as well as buy and sell in secondary market, they have direct contribution on forming yield of sovereign bonds.

Tchuindjo [-@Tchuindjo2015] writes that primary dealers will make bilateral contracts for the offered securities as soon as auction announced, known as pre-sale or when-issued market. Mercer et al. [-@Mercer2013] argue that they will be able to "discover" the ultimate auction price since in pre-sale period. Many primary dealers are also believed to often short in the when-issued market [@Nyborg2004], which encourages them to bid aggressively and assign lower prices to the auctioned securities [@Tchuindjo2015], meaning higher demanded yields.

Thus, our analysis will be based on an assumption that primary dealersâ€™ strategic behavior in the auctions can affect sovereign bonds yield. To check this assumption, we use dummy variables of "auction days" that representing the pre-sale/when-issued period and "non-auction days" that representing regular workdays. Referring to Nyborg et al. [-@Nyborg2004] pre-sale period is described as days started from the day of auction announcement (T-3) until a moment before bonds is distributed on the day of settlement (T+2). For simplicity, we define auction days as days started from T-3 until T+1. Here, we exclude the day of settlement (T+2) since bonds is usually distributed by the Central Bank in the morning of the settlement day. In addition, we only include auction days that offer benchmark series of the 10-year sovereign bonds in the auction day (T). Before 2019, the 10-year series is not regularly offered in the auction.


```{r echo = FALSE}
### auction vs non_auc days

cek5 <- yield_ts %>% as_tibble %>% 
  select(date, domestic_10y, auction_day) %>% 
  mutate(date = date(date))

yielddif_auction <- cek5 %>% 
  ungroup %>%
  arrange(date) %>% 
  mutate(
    auction_lag = lag(auction_day, default = 0),
    id = cumsum(auction_day != auction_lag)
  ) %>% 
  select(-auction_lag) %>% 
  group_by(id) %>% 
  mutate(
    edge = case_when(
      date == min(date) ~ "from",
      date == max(date) ~ "to",
      T ~ NA_character_
      )
  ) %>% 
  ungroup %>% 
  filter(!is.na(edge)) %>% 
  pivot_wider(
    names_from = edge, 
    values_from = c(date, domestic_10y),
  ) %>% 
  select(-id) %>% 
  mutate(
    difference = domestic_10y_to - domestic_10y_from
  )


```

In order to check if the yield difference of these two periods is really significant or not, we create new variable "difference" that is calculated by subtracting yield of the last with the first day for each period. The summary table of the yield difference (showing only first 10 rows) can be seen in table \@ref(tab:yielddiftable).

```{r yielddiftable, warning = FALSE, message= FALSE}
library(kableExtra)
yielddif_auction %>% slice(1:10) %>% knitr::kable(caption = "The Yield's Difference between Auction and Non-Auction Days") %>% kable_styling(latex_options = "HOLD_position", bootstrap_options = "striped", stripe_color = "grey")
```


```{r yielddifline, fig.cap = "The Yield Difference in Auction and Non Auction Days", warning = FALSE, message= FALSE,fig.align='center'}
### yield difference in geom line by year
## difference between first and last day in auction or non-auction days
yielddif_auction %>% as_data_frame() %>%  mutate(no = as.numeric(rownames(yielddif_auction))) %>% as_tsibble(index = no) %>% ggplot(aes(y = difference, x = date_to, group = factor(auction_day), color = factor(auction_day)))+geom_line()+
 scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position="bottom")
  
```

After the calculation, we visualize the difference of yield in each period as shown in figure \@ref(fig:yielddifline). From the figure, we can see that in 2015 and 2016 yield difference in auction days tend to be negative which indicate that the yield of last day in the period are lower than the first day. In other words, yield tend to increase preceding an auction event which support the argument of Tchuindjo [-@Tchuindjo2015]. Nevertheless, this seems not to be the case in more recent years.  
In addition, using boxplot to visualize the difference as seen in figure \@ref(fig:yielddifbox), the median difference between auction and non-auction days are also quite similar.

```{r yielddifbox, fig.cap= "Boxplot of Yield Difference by Year", fig.align='center'}
yielddif_auction %>% mutate(auction_day = factor(auction_day), month = month(date_to), year = year(date_to)) %>%  na.omit() %>% 
  ggplot(aes(y = difference, group = auction_day, color = auction_day))+
  geom_boxplot()+
  facet_wrap(~ year, scales = "free", nrow = 2)+
  ylab("Yield Difference")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position="bottom")
```



\newpage

# Research Methodology

In conducting analysis on determining factors for the 10-year LCB yield, we will use dynamic regression model (DRM) to explain relation between our response and its predictors. There are two main advantages of using this type of model. First, it supports the use of regular linear regression model. Second, it enables us to combine the regression with ARIMA model that will handle timeseries dynamics [@Hyndman]. Thus, our DRM will consist of a linear regression model and an ARIMA model.

Before constructing the DRM, we will apply some preliminary testing as a standard procedure for implementing linear regression with time series variables. First, we will check multicolinearity between the predictors fitted in the linear regression model. Second, as ARIMA model requires all variables to be stationer except if they are cointegrated [@Hyndman], we will check whether our response and predictors are cointegrated.

The last step is to fit DRM and analyze performance of the model by forecasting the yield based on the DRM and comparing the prediction with the real yield.


## Multicolinearity test

For conducting multicolinearity test, we build a linear model with the LCB yield as a response and remaining variables as predictors. Then, we calculate Variance Inflation Factor (VIF) of all predictors. The result can be seen table \@ref(tab:multicol).

```{r multicol}

# For a given predictor (p), multicollinearity can assessed by computing a score called the variance inflation factor (or VIF), which measures how much the variance of a regression coefficient is inflated due to multicollinearity in the model.
# 
# The smallest possible value of VIF is one (absence of multicollinearity). As a rule of thumb, a VIF value that exceeds 5 or 10 indicates a problematic amount of collinearity (James et al. 2014).

model1 <- lm(domestic_10y ~ ust_10y + vix + cds_5y + rate + foreign + exchange_mid + auction_day, data = yield_ts)

library(caret)
car::vif(model1) %>% tidy() %>%  rename(variable = names, VIF = x) %>% kable(caption = "Result of Multicolinearity Test") %>% kable_styling(bootstrap_options = "striped")
```

From the result we see that all VIF values are still below 10 as the upper threshold of multicolinearity, with two variables; 5y-CDS and foreign ownership, have values exceed the conservative threshold of 5. However, since the dataset used in this study is considered large we can use the upper threshold for multicolinearity indication as suggested by Jongh et al. [-@Jongh2015]. Thus, we can use all variables in our model since there is no presence of multicolinearity. 

## Cointegration test

Cointegration test is an important preliminary check before analysing time series of regression model especially in economics and finance, since many variables used in these fields are usually non-stationer, and regressing non-stationer time series could potentially produce spurious results [-@Wharton]. At the same time, if we try to use difference for all non-stationer predictors (detrending), this approach will erase all long run effect of these variables with only short run dynamics remains [-@Wharton]. As a result, the explanatory power of the model will be weakened. 

The concept of cointegration can be described as follows: while individual variable is simply non-stationer, their long-run combination with other variables could potentially be stationer [-@Wharton]. Hence, we will check if all of our time series used in this study are actually cointegrated. 

For this purpose, we will use Johansen procedure [@Johansen1991] ^[The Johansen procedure is conducted in R using library urca (Pfaff, B. 2008)] since this testing method enable us to use combination of more than two time series. As a requirement for the test, we must ensure that all time series are at the same level of order integration one I(1). Using Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test [@Kwiatkowski1992] to check required difference for all variables, we see that the foreign ownership variable is the only variable that need to be double differenced, or in other words this variable is in order of integration I(2) instead of I(1). Thus, we will use a single differenced version of this variable (diff_foreign) so as to make its integration order I(1) in the cointegration testing. No seasonal difference is needed for all variables. Full result of the KPSS test can be seen in table \@ref(tab:kpsstab)^[ndiff = regular difference needed, nsdiff = seasonal difference needed]. 


```{r kpsstab}

# The Johansen test is more flexible than the CADF procedure outlined in the previous article and can check for multiple linear combinations of time series for forming stationary portfolios

# all variables must be integrated in the same order
# step 1 check lag required
yield_fc %>% 
  features_at(vars(domestic_10y, ust_10y, vix, foreign, cds_5y, exchange_mid, rate), list(unitroot_kpss, unitroot_ndiffs, unitroot_nsdiffs)) %>% 
  pivot_longer(names_to = "unit root", cols = everything()) %>% 
    kable(caption = "Table of Unitroot Test") %>% 
  kable_styling(bootstrap_options = 'striped', stripe_color = "#FFFFF")
## kpss_pval less than 0.1 hence non-stationer for all variables
##foreign percentage needs 2-differencing hence make it diff 1 to make it equal
```


```{r}

df_cajo <- yield_fc %>% 
  mutate(dif_foreign = difference(foreign)) %>% 
select(domestic_10y, ust_10y, vix, dif_foreign, cds_5y, exchange_mid, rate) %>% 
  # mutate(d_for = for_pct %>% difference()) %>% 
  as_tibble() %>% 
  select(-date)

m <- ca.jo(data.frame(df_cajo$domestic_10y, df_cajo$ust_10y,  df_cajo$vix,  df_cajo$dif_foreign,  df_cajo$cds_5y,  df_cajo$exchange_mid,  df_cajo$rate),
          ecdet = "none", type = "trace", K = 2, spec = "longrun")

# max lag 2, 
## H0 = no cointegration among variables

# summary(m)

```

The Johansen procedure is conducted using trace statistic method that produce eigenvalues ($\lambda$), rank of the matrix as shown in table \@ref(tab:rankmatrix) and eigenvector associated with the highest eigenvalue as shown in table \@ref(tab:compeig). The first hypothesis, r=0, tests for the presence of cointegration between all seven variables included. It is clear that since the test statistic exceeds the 1% level significantly (868.11) we have strong evidence to reject the null hypothesis of no cointegration.

```{r}
# lambda (eigenvalues)
data.frame(m@lambda) %>% rename(lambda = m.lambda) %>%  kable(align = "l", caption = "Eigenvalues of Variable's Linear Combination") %>% kable_styling(bootstrap_options = "striped")
```


```{r rankmatrix}
test_cajo <- data.frame(m@teststat) %>% rename(test_stat = m.teststat)

sig_cajo <- data.frame(m@cval) %>% rename(lev_10pct = X10pct, lev_5pct = X5pct, lev_1pct = X1pct) 

rank_result <- cbind(sig_cajo, test_cajo)

rank_result %>% 
kable(caption = "Rank of the Matrix") %>% kable_styling(bootstrap_options = "striped", stripe_color = "grey")

# How do we go about forming such a linear combination? The answer is to make use of the eigenvector components of the eigenvector associated with the largest eigenvalue. We previously mentioned that the largest eigenvalue is approximately pl2. It corresponds to the vector given under the column p.l2, and is approximately equal to . If we form a linear combination of series using these components, we will receive a stationary series:
  
```

```{r compeig}
comp_eig <- data.frame(m@V) %>% select(1) %>%
  rename(lcb_yield = df_cajo.domestic_10y.l2)

rownames(comp_eig) <- c("lcb_yield","ust_yield","vix","dif_foreign", "cds", "exchange rate", "policy rate")

comp_eig %>% 
  kable(caption = "Component of Eigenvector for 10y-LCB yield") %>% kable_styling(bootstrap_options = "striped")
```

Other test statistics for r<=1, r<=2 and r<=3 also show that the null hypothesis of no cointegration can be rejected. However, for the higher rank of matrix the null hypothesis cannot be rejected. Hence, we can conclude that in order to form linear combination that poses cointegration we need at least 4 combination of the variables. Using all combination (7 variables) can perfectly make these time series cointegrated. 

Summing up cointegration values from multiplication of eigenvector in table \@ref(tab:eigen) with its corresponding variable, we can visualize the stationary of the linear combination of all time series as shown in figure \@ref(fig:viscoin). 

$Cointegration\_values  = 1*lcb\_10y + 0.2217401*ust\_10y + 0.106*vix + 4438.76*diff\_foreign - 0.007*cds\_5y - 0.0004*exchange - 0.621*rate$

```{r viscoin, fig.cap= "Stationarity of Cointegrated Variables", fig.align='center'}
# eigenvalues * each variable dataframe
s <-(1.000000e+00*df_cajo$domestic_10y) + (0.2217401237 *df_cajo$ust_10y) + (0.1216112 *df_cajo$vix) + (1.5841457*df_cajo$dif_foreign) - (0.0081862  *df_cajo$cds_5y) - (0.0007258*df_cajo$exchange_mid) - (0.5994640*df_cajo$rate)

#remove NA value
value <- s[!is.na(s)]

# plot cointegration
plot(value, type="l")# looks stationer
```

From the figure, we see that long-run effect of all combined variables seems not significantly different from zero (white noise) hence we can conclude that they are all cointegrated based on this visualization.


## Dynamic Regression Model

Regarding the result from the previous section, we can write down equation of the relation between variables in dynamic regression model as follow:

$$
\begin{aligned}
y_t = &\beta_0 + \beta_1 x_{1t} + \beta_2 x_{2t} + \beta_3 x_{3t} + \beta_4 x_{4t} + \beta_5 x_{5t} + \beta_6 x_{6t} + \beta_7 x_{7t} + \eta_t
\end{aligned}
$$
where \(x\) represent each predictor and \(\eta_t\) is an ARIMA error.

Summary statistic of the data is shown in table \@ref(tab:table1).

```{r table1, results = 'asis'}

###prepare variable for model
data_model <- df_cajo %>% rename(lcb_10y = domestic_10y, exchange_rate = exchange_mid, pol_rate = rate)

stargazer(as.data.frame(data_model), type = "latex", header = FALSE,
           label = "tab:table1")
```


\newpage  

# Analysis

## Model Inference


From the model statistics at table \@ref(tab:tabstat), all variables are significant on 5% level except for vix, dif_foreign and auction_day1. The pvalue of vix is significant on 10% level, while the dif_foreign and auction_day1 are not significant. Predictors with positive correlation are 10y-UST yield, 5y-CDS, Exchange Rate, and VIX, while Policy Rate, Foreign Ownership and Auction Day pose negative correlation.  

```{r tabstat}
# ARIMA describe autocorrelations in the data
yield_mod <- yield_fc %>%
  mutate(dif_foreign = difference(foreign), auction_day = as.factor(auction_day)) %>% 
  select(date, domestic_10y, ust_10y, cds_5y, exchange_mid, vix, rate, dif_foreign, auction_day)

# ARIMA function choose automatically
fit <- yield_mod %>% 
  model(ARIMA(domestic_10y ~ ust_10y + cds_5y + exchange_mid + vix + rate + dif_foreign + auction_day))

# report(fit)
# LM w/ ARIMA(2,1,0)(1,0,0)[7] errors 
# 7-day seasonal pattern, non-seasonal AR(2) and seasonal AR(1) with 1 difference.

fit_tidy <- tidy(fit)

fit_tidy %>% mutate(pval = round(as.numeric(format(p.value, scientific = F)), digits = 3)) %>% 
  select(-p.value, -.model) %>% 
  kable(caption = "Model Statistic") %>% kable_styling(bootstrap_options = "striped")

```

Interpretation from each predictor's coefficient is as follows:  

1. for 1% increase in 10y-UST yield, the LCB yield will increase about 14bps  

1. for 10 increase in 5y-CDS, the LCB yield will increase about 4bps  

1. for 1000 increase in USD/IDR exchange rate, the LCB yield will increase about 43bps  

1. for 10 increase in VIX, the LCB yield will increase about 1bps  

1. for 1% increase in policy rate, the LCB yield will decrease about 8bps  

1. for IDR100 trillion increase in foreign ownership, the LCB yield will decrease about 2bps  

1. for each day in auction period, the LCB yield will decrease about 0.1bps compared to non-auction day.  


## Performance of the Model

### Residual Check

In this section we will check if residuals from the DRM is resembling white noise. This is important to make sure that there is no significant information left in the residuals that should be used in our model [@Hyndman]. 

Using gg_tsresiduals function from library Feasts [@Feasts] to visualize the innovation residuals, we can see that the residuals of the estimated ARIMA errors (2,1,0)(1,0,0) seems not different from a white noise. The visualization is shown in figure \@ref(fig:innov).

```{r innov, fig.cap= "Innovation Residuals of the Model", fig.align='center'}
fit %>% gg_tsresiduals()

```

We complement the visualization check with formal test using Ljung-Box test to support the finding. From the result, we can confirm that the residuals are similar to white noise since the pvalue produced (with lag = 21) is large (0.50).  


```{r}
box_test <- augment(fit) %>%
  features(.innov, ljung_box, lag = 21) %>% select(lb_stat, lb_pvalue)

box_test %>% 
kable(caption = "Ljung-Box Test on Innovation Residuals", align = "l") %>% 
  kable_styling(bootstrap_options = "striped")
```

### Prediction Using Model 

In this section we will evaluate performance of the model by making prediction on the real 5y-LCB yield. The prediction will be based on the fitted model of training dataset. For this purpose, we separate dataset into training and testing data. The training data contains all observations up to 31 December 2020, while the testing data contains all observations from 1 January 2021 until 8 August 2021. 

Since our purpose is to predict the real 10y- LCB yield, we will use real data of the predictors instead of forecasting each of these exogenous variables. The prediction is using library Forecast in R [@Forecast] and the result can be seen in figure \@ref(fig:modperf).


```{r}
# reserve 2021 for test data
train <- yield_mod  %>% 
  filter_index(.~ "2020-12-31")

test <- yield_mod %>% 
  filter(date >= '2020-12-31') 

#fit the same model
myfit <- train %>%
  model(ARIMA(domestic_10y ~ ust_10y + cds_5y  + exchange_mid + vix + rate + dif_foreign + auction_day + pdq(2,1,0) + PDQ(1,0,0)))

```

```{r modperf, fig.cap="Performance of Model in Predicting Real 10y-LCB Yield", fig.align='center', out.width= "100%"}
# forecast using real data
myfit %>%
  forecast(test) %>% 
  autoplot(yield_mod)+
  ylab("10y-LCB yield")+theme_light()
    
```

From the plot, the DRM seems to nicely capture the LCB yield's dynamics (trend and volatility) quite well. The gap between prediction and real yield is moderate and the real yield still mostly covered inside the 80% prediction interval band.

```{r foreror}
accuracy <- myfit %>%
  forecast(test) %>% 
  accuracy(yield_fc) %>% select(-1, -2)

accuracy %>% kable(caption = "Forecast Error of the Model") %>% kable_styling(bootstrap_options = "striped")

#Scaled errors were proposed by Hyndman & Koehler (2006) as an alternative to using percentage errors when comparing forecast accuracy across series with different units

# Low error both RMSE 0.3581206 and MASE 2.54829

```

From table \@ref(tab:foreror), the DRM seems to have very low prediction error indicated by small score of RMSE and MASE that are 0.3581206 and 2.54829 consecutively.  
  
\newpage
\newpage  
  
  
  
# Appendix

The yield movement in auction and non auction days from 2015-2021 are shown in the visualization below:

```{r yieldmove, fig.cap="10-year Yield's Movement in Auction and Non-Auction Days", out.width= "70%", fig.align = "center"}
average_2015 <- yield_ts %>% as_tibble() %>% mutate(year = year(date)) %>%  filter(year == 2015) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2016 <- yield_ts %>% as_tibble() %>%  mutate(year = year(date)) %>%  filter(year == 2016) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2017 <- yield_ts %>% as_tibble() %>% mutate(year = year(date)) %>% filter(year == 2017) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2018 <- yield_ts %>%as_tibble() %>%  mutate(year = year(date)) %>% filter(year == 2018) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2019 <- yield_ts %>% as_tibble() %>% mutate(year = year(date)) %>% filter(year == 2019) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2020 <- yield_ts %>% as_tibble() %>% mutate(year = year(date)) %>% filter(year == 2020) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))

average_2021 <- yield_ts %>% as_tibble() %>% mutate(year = year(date)) %>% filter(year == 2021) %>%
  mutate(month = month(date, label = TRUE)) %>%
  group_by(month) %>%  summarise(mean = mean(domestic_10y))


yield_move <- function(data, x){

  average_line <- get(str_glue("average_", as.character(x)))
  title <- str_glue("Yield's Movement in ", as.character(x))
  
  data  %>% as_tibble() %>% 
  mutate(month = lubridate::month(date, label = TRUE), year = year(date)) %>%
  filter(year == x) %>% 
ggplot(aes(x = factor(day(date)), y = domestic_10y, color = factor(auction_day), alpha = 0.1))+
  geom_jitter(alpha = 1, size = 2)+scale_x_discrete(breaks = seq(1, 31, 9))+scale_y_continuous(minor_breaks = 1)+
  geom_hline(data = average_line, aes(yintercept = mean, linetype = "Monthly Average"), colour= 'black')+
  facet_wrap(~month, scale = "free")+xlab("Date")+ylab("10y Yield")+
  scale_color_manual(name = "Auction Days", values= c("#BCBCBC", "#F55F5F"), labels = c("No", "Yes"))+
  scale_linetype_manual(name = "", values = "dashed")+theme_light()+theme(legend.position="bottom")+ggtitle(title)
}

yield_move(yield_ts, 2015)
yield_move(yield_ts, 2016)
yield_move(yield_ts, 2017)
yield_move(yield_ts, 2018)
yield_move(yield_ts, 2019)
yield_move(yield_ts, 2020)
yield_move(yield_ts, 2021)

```

```{r yieldbox, fig.cap="10-year LCB Yield's Movement during Auction Days from 2015-2021"}
yield_box <- function(data, year){
  title <- str_glue("10-year LCB Yield's Movement in ", as.character(year))
  
  data  %>%
  filter(year(date)== year) %>% 
  mutate(month = month(date, label = TRUE), year = year(date)) %>%
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~month, scales = "free")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+
  theme_light()+theme(legend.position = "bottom")+ggtitle(title)
}


```

```{r, fig.align='center', out.width= "70%"}
yield_box(yield_ts, 2015)
```

```{r, fig.align='center', out.width= "70%"}
yield_box(yield_ts, 2016)
```

```{r, fig.align='center', out.width= "70%"}
yield_box(yield_ts, 2017)
```

```{r, fig.align='center', out.width= "70%"}
yield_box(yield_ts, 2018)
```

```{r, fig.align='center', out.width= "70%"}
yield_box(yield_ts, 2019)
```

```{r, fig.align='center', out.width= "70%"}
yield_box(yield_ts, 2020)
```

```{r, fig.align='center', out.width= "70%"}
yield_box(yield_ts, 2021)
```



The boxplot of yield movement for each year (2015-2021) can be seen in the following plots:

```{r fig.cap= "Boxplot of 10-year Yield's Movement during Auction and Non-Auction Days by Year", out.width= "70%", fig.align = "center"}
######comparing yield in auction day and non-auction day
# slightly higher in Feb and Dec
yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>% 
  select(domestic_10y, auction_day, month, year) %>% drop_na() %>% 
  filter(year == 2015) %>% 
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~ month, scales = "free")+ylab("10-year Yield")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position = "bottom")+
  ggtitle("Boxplot of 10-year Yield's Movement in 2015")

yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>% 
  select(domestic_10y, auction_day, month, year) %>% drop_na() %>% 
  filter(year == 2016) %>% 
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~ month, scales = "free")+ylab("10-year Yield")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position = "bottom")+
  ggtitle("Boxplot of 10-year Yield's Movement in 2016")


yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>% 
  select(domestic_10y, auction_day, month, year) %>% drop_na() %>% 
  filter(year == 2017) %>% 
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~ month, scales = "free")+ylab("10-year Yield")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position = "bottom")+
  ggtitle("Boxplot of 10-year Yield's Movement in 2017")


yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>% 
  select(domestic_10y, auction_day, month, year) %>% drop_na() %>% 
  filter(year == 2018) %>% 
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~ month, scales = "free")+ylab("10-year Yield")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position = "bottom")+
  ggtitle("Boxplot of 10-year Yield's Movement in 2018")


yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>% 
  select(domestic_10y, auction_day, month, year) %>% drop_na() %>% 
  filter(year == 2019) %>% 
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~ month, scales = "free")+ylab("10-year Yield")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position = "bottom")+
  ggtitle("Boxplot of 10-year Yield's Movement in 2019")


yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>% 
  select(domestic_10y, auction_day, month, year) %>% drop_na() %>% 
  filter(year == 2020) %>% 
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~ month, scales = "free")+ylab("10-year Yield")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position = "bottom")+
  ggtitle("Boxplot of 10-year Yield's Movement in 2020")


yield_factors  %>%
  mutate(month = month(date, label = TRUE), year = year(date)) %>% 
  select(domestic_10y, auction_day, month, year) %>% drop_na() %>% 
  filter(year == 2021) %>% 
ggplot(aes(y= domestic_10y, group = auction_day, color = factor(auction_day)))+
  geom_boxplot()+
  facet_wrap(~ month, scales = "free")+ylab("10-year Yield")+
  scale_color_discrete(name = "Auction Days", labels = c("No", "Yes"))+theme_light()+theme(legend.position = "bottom")+
  ggtitle("Boxplot of 10-year Yield's Movement in 2021")

```


The boxplot of yield difference between first day and last day in auction days as well as non-auction Days for each year:

```{r warning= FALSE, message= FALSE, out.width= "70%", fig.align = "center"}
### Difference of auction day vs non
# 2015
yielddif_auction %>% mutate(auction_day = factor(auction_day), month = month(date_to, label = TRUE), year = year(date_to)) %>% drop_na() %>% 
  filter(year == 2015) %>% 
  ggplot(aes(y = difference, group = auction_day, color = auction_day))+
  geom_boxplot()+facet_wrap(~ month, scales = "free")+ggtitle("Difference of Yield between Auction/Non-Auction Days in 2015")

#2016
yielddif_auction %>% mutate(auction_day = factor(auction_day), month = month(date_to, label = TRUE), year = year(date_to)) %>% drop_na() %>% 
  filter(year == 2016) %>% 
  ggplot(aes(y = difference, group = auction_day, color = auction_day))+
  geom_boxplot()+facet_wrap(~ month, scales = "free")+ggtitle("Difference of Yield between Auction/Non-Auction Days in 2016")
#2017
yielddif_auction %>% mutate(auction_day = factor(auction_day), month = month(date_to, label = TRUE), year = year(date_to)) %>% drop_na() %>% 
  filter(year == 2017) %>% 
  ggplot(aes(y = difference, group = auction_day, color = auction_day))+
  geom_boxplot()+facet_wrap(~ month, scales = "free")+ggtitle("Difference of Yield between Auction/Non-Auction Days in 2017")
#2018
yielddif_auction %>% mutate(auction_day = factor(auction_day), month = month(date_to, label = TRUE), year = year(date_to)) %>% drop_na() %>% 
  filter(year == 2018) %>% 
  ggplot(aes(y = difference, group = auction_day, color = auction_day))+
  geom_boxplot()+facet_wrap(~ month, scales = "free")+ggtitle("Difference of Yield between Auction/Non-Auction Days in 2018")


```

```{r yielddifyear, fig.cap = "Yield Difference between First & Last Day in Auction and Non-Auction Days"}
# by year
# yielddif_auction %>% as_data_frame() %>%  mutate(no = as.numeric(rownames(yielddif_auction))) %>% as_tsibble(index = no) %>% 
#   ggplot(aes(y = difference, x = date_to, group = factor(auction_day), color = factor(auction_day)))+geom_line()+facet_wrap(~ year(date_from), scales = "free")+
# xlab("Date")+
# theme(legend.position = "bottom")
```

\newpage  

# Bibliography

